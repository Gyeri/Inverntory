/*! For license information please see 911.88afc799.chunk.js.LICENSE.txt */
(self.webpackChunkinventory_client=self.webpackChunkinventory_client||[]).push([[911],{4911:function(e){!function(t,r){var n=r.toString();e.exports=r(n)}(0,function(e){var t,r,n,o;!function(e){var o,a,i,u,c={},s={},l={},f={},d=Object.prototype.hasOwnProperty,h=[].slice,p=/\.js$/;function g(e,t){return d.call(e,t)}function y(e,t){var r,n,o,a,i,u,c,s,f,d,h,g=t&&t.split("/"),y=l.map,m=y&&y["*"]||{};if(e&&"."===e.charAt(0))if(t){for(g=g.slice(0,g.length-1),i=(e=e.split("/")).length-1,l.nodeIdCompat&&p.test(e[i])&&(e[i]=e[i].replace(p,"")),e=g.concat(e),f=0;f<e.length;f+=1)if("."===(h=e[f]))e.splice(f,1),f-=1;else if(".."===h){if(1===f&&(".."===e[2]||".."===e[0]))break;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((g||m)&&y){for(f=(r=e.split("/")).length;f>0;f-=1){if(n=r.slice(0,f).join("/"),g)for(d=g.length;d>0;d-=1)if((o=y[g.slice(0,d).join("/")])&&(o=o[n])){a=o,u=f;break}if(a)break;!c&&m&&m[n]&&(c=m[n],s=f)}!a&&c&&(a=c,u=s),a&&(r.splice(0,u,a),e=r.join("/"))}return e}function m(t,r){return function(){return a.apply(e,h.call(arguments,0).concat([t,r]))}}function v(e){return function(t){c[e]=t}}function _(t){if(g(s,t)){var r=s[t];delete s[t],f[t]=!0,o.apply(e,r)}if(!g(c,t)&&!g(f,t))throw new Error("No "+t);return c[t]}function x(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function w(e){return function(){return l&&l.config&&l.config[e]||{}}}i=function(e,t){var r,n=x(e),o=n[0];return e=n[1],o&&(r=_(o=y(o,t))),o?e=r&&r.normalize?r.normalize(e,function(e){return function(t){return y(t,e)}}(t)):y(e,t):(o=(n=x(e=y(e,t)))[0],e=n[1],o&&(r=_(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:r}},u={require:function(e){return m(e)},exports:function(e){var t=c[e];return"undefined"!==typeof t?t:c[e]={}},module:function(e){return{id:e,uri:"",exports:c[e],config:w(e)}}},o=function(t,r,n,o){var a,l,d,h,p,y,x=[],w=typeof n;if(o=o||t,"undefined"===w||"function"===w){for(r=!r.length&&n.length?["require","exports","module"]:r,p=0;p<r.length;p+=1)if("require"===(l=(h=i(r[p],o)).f))x[p]=u.require(t);else if("exports"===l)x[p]=u.exports(t),y=!0;else if("module"===l)a=x[p]=u.module(t);else if(g(c,l)||g(s,l)||g(f,l))x[p]=_(l);else{if(!h.p)throw new Error(t+" missing "+l);h.p.load(h.n,m(o,!0),v(l),{}),x[p]=c[l]}d=n?n.apply(c[t],x):void 0,t&&(a&&a.exports!==e&&a.exports!==c[t]?c[t]=a.exports:d===e&&y||(c[t]=d))}else t&&(c[t]=n)},t=r=a=function(t,r,n,c,s){if("string"===typeof t)return u[t]?u[t](r):_(i(t,r).f);if(!t.splice){if((l=t).deps&&a(l.deps,l.callback),!r)return;r.splice?(t=r,r=n,n=null):t=e}return r=r||function(){},"function"===typeof n&&(n=c,c=s),c?o(e,t,r,n):setTimeout(function(){o(e,t,r,n)},4),a},a.config=function(e){return a(e)},t._defined=c,(n=function(e,t,r){t.splice||(r=t,t=[]),g(c,e)||g(s,e)||(s[e]=[e,t,r])}).amd={jQuery:!0}}(),n("almond",function(){}),n("image_loader",[],function(){"use strict";var e={};function t(e,t){e.onload=function(){t.loaded(this)}}return e.load=function(e,r,n,o,a){var i,u,c,s=new Array(o),l=new Array(s.length);if(!1===a)s[0]=e;else for(i=0;i<s.length;i++)c=n+i,s[i]=e+"image-"+("00"+c).slice(-3)+".jpg";for(l.notLoaded=[],l.addImage=function(e){l.notLoaded.push(e)},l.loaded=function(e){for(var t=l.notLoaded,n=0;n<t.length;n++)if(t[n]==e){t.splice(n,1);for(var o=0;o<s.length;o++){var a=s[o].substr(s[o].lastIndexOf("/"));if(-1!=e.src.lastIndexOf(a)){l[o]=e;break}}break}0===t.length&&(console.log("Images loaded"),r.apply(null,[l]))},i=0;i<s.length;i++)u=new Image,l.addImage(u),t(u,l),u.src=s[i]},e}),n("input_stream",["image_loader"],function(e){"use strict";var t={};return t.createVideoStream=function(e){var t,r,n={},o=null,a=["canrecord","ended"],i={},u={x:0,y:0},c={x:0,y:0};return n.getRealWidth=function(){return e.videoWidth},n.getRealHeight=function(){return e.videoHeight},n.getWidth=function(){return t},n.getHeight=function(){return r},n.setWidth=function(e){t=e},n.setHeight=function(e){r=e},n.setInputStream=function(t){o=t,e.src="undefined"!==typeof t.src?t.src:""},n.ended=function(){return e.ended},n.getConfig=function(){return o},n.setAttribute=function(t,r){e.setAttribute(t,r)},n.pause=function(){e.pause()},n.play=function(){e.play()},n.setCurrentTime=function(t){"LiveStream"!==o.type&&(e.currentTime=t)},n.addEventListener=function(t,r,n){-1!==a.indexOf(t)?(i[t]||(i[t]=[]),i[t].push(r)):e.addEventListener(t,r,n)},n.clearEventHandlers=function(){a.forEach(function(t){var r=i[t];r&&r.length>0&&r.forEach(function(r){e.removeEventListener(t,r)})})},n.trigger=function(a,u){var s,l=i[a];if("canrecord"===a&&function(){var n=e.videoWidth,a=e.videoHeight;t=o.size?n/a>1?o.size:Math.floor(n/a*o.size):n,r=o.size?n/a>1?Math.floor(a/n*o.size):o.size:a,c.x=t,c.y=r}(),l&&l.length>0)for(s=0;s<l.length;s++)l[s].apply(n,u)},n.setTopRight=function(e){u.x=e.x,u.y=e.y},n.getTopRight=function(){return u},n.setCanvasSize=function(e){c.x=e.x,c.y=e.y},n.getCanvasSize=function(){return c},n.getFrame=function(){return e},n},t.createLiveStream=function(e){e.setAttribute("autoplay",!0);var r=t.createVideoStream(e);return r.ended=function(){return!1},r},t.createImageStream=function(){var t,r,n={},o=null,a=0,i=0,u=0,c=!0,s=!1,l=null,f=0,d=null,h=!1,p=["canrecord","ended"],g={},y={x:0,y:0},m={x:0,y:0};function v(e,t){var r,o=g[e];if(o&&o.length>0)for(r=0;r<o.length;r++)o[r].apply(n,t)}return n.trigger=v,n.getWidth=function(){return t},n.getHeight=function(){return r},n.setWidth=function(e){t=e},n.setHeight=function(e){r=e},n.getRealWidth=function(){return a},n.getRealHeight=function(){return i},n.setInputStream=function(n){o=n,!1===n.sequence?(d=n.src,f=1):(d=n.src,f=n.length),s=!1,e.load(d,function(e){l=e,a=e[0].width,i=e[0].height,t=o.size?a/i>1?o.size:Math.floor(a/i*o.size):a,r=o.size?a/i>1?Math.floor(i/a*o.size):o.size:i,m.x=t,m.y=r,s=!0,u=0,setTimeout(function(){v("canrecord",[])},0)},1,f,o.sequence)},n.ended=function(){return h},n.setAttribute=function(){},n.getConfig=function(){return o},n.pause=function(){c=!0},n.play=function(){c=!1},n.setCurrentTime=function(e){u=e},n.addEventListener=function(e,t){-1!==p.indexOf(e)&&(g[e]||(g[e]=[]),g[e].push(t))},n.setTopRight=function(e){y.x=e.x,y.y=e.y},n.getTopRight=function(){return y},n.setCanvasSize=function(e){m.x=e.x,m.y=e.y},n.getCanvasSize=function(){return m},n.getFrame=function(){var e;return s?(c||(e=l[u],u<f-1?u++:setTimeout(function(){h=!0,v("ended",[])},0)),e):null},n},t}),glMatrixArrayType=Float32Array,"undefined"!==typeof window&&(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)},navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL),Math.imul=Math.imul||function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16&65535)*n+r*(t>>>16&65535)<<16>>>0)|0},n("typedefs",(o=this,function(){return o.typedefs})),n("subImage",["typedefs"],function(){"use strict";function e(e,t,r){r||(r={data:null,size:t}),this.data=r.data,this.originalSize=r.size,this.I=r,this.from=e,this.size=t}return e.prototype.show=function(e,t){var r,n,o,a,i,u,c;for(t||(t=1),r=e.getContext("2d"),e.width=this.size.x,e.height=this.size.y,o=(n=r.getImageData(0,0,e.width,e.height)).data,a=0,i=0;i<this.size.y;i++)for(u=0;u<this.size.x;u++)c=i*this.size.x+u,a=this.get(u,i)*t,o[4*c+0]=a,o[4*c+1]=a,o[4*c+2]=a,o[4*c+3]=255;n.data=o,r.putImageData(n,0,0)},e.prototype.get=function(e,t){return this.data[(this.from.y+t)*this.originalSize.x+this.from.x+e]},e.prototype.updateData=function(e){this.originalSize=e.size,this.data=e.data},e.prototype.updateFrom=function(e){return this.from=e,this},e}),n("cluster",[],function(){"use strict";return{create:function(e,t){var r=[],n={rad:0,vec:s.create([0,0])},o={};function a(e){o[e.id]=e,r.push(e)}function i(){var e,t=0;for(e=0;e<r.length;e++)t+=r[e].rad;n.rad=t/r.length,n.vec=s.create([Math.cos(n.rad),Math.sin(n.rad)])}return a(e),i(),{add:function(e){o[e.id]||(a(e),i())},fits:function(e){return Math.abs(s.dot(e.point.vec,n.vec))>t},getPoints:function(){return r},getCenter:function(){return n}}},createPoint:function(e,t,r){return{rad:e[r],point:e,id:t}}}});var a={create:function(e){var t;return e?((t=new glMatrixArrayType(3))[0]=e[0],t[1]=e[1],t[2]=e[2]):t=glMatrixArrayType===Array?new glMatrixArrayType([0,0,0]):new glMatrixArrayType(3),t},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},add:function(e,t,r){return r&&e!=r?(r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r):(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e)},subtract:function(e,t,r){return r&&e!=r?(r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r):(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e)},negate:function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},scale:function(e,t,r){return r&&e!=r?(r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r):(e[0]*=t,e[1]*=t,e[2]*=t,e)},normalize:function(e,t){t||(t=e);var r=e[0],n=e[1],o=e[2],a=Math.sqrt(r*r+n*n+o*o);return a?1==a?(t[0]=r,t[1]=n,t[2]=o,t):(a=1/a,t[0]=r*a,t[1]=n*a,t[2]=o*a,t):(t[0]=0,t[1]=0,t[2]=0,t)},cross:function(e,t,r){r||(r=e);var n=e[0],o=e[1],a=e[2],i=t[0],u=t[1],c=t[2];return r[0]=o*c-a*u,r[1]=a*i-n*c,r[2]=n*u-o*i,r},length:function(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},direction:function(e,t,r){r||(r=e);var n=e[0]-t[0],o=e[1]-t[1],a=e[2]-t[2],i=Math.sqrt(n*n+o*o+a*a);return i?(i=1/i,r[0]=n*i,r[1]=o*i,r[2]=a*i,r):(r[0]=0,r[1]=0,r[2]=0,r)},lerp:function(e,t,r,n){return n||(n=e),n[0]=e[0]+r*(t[0]-e[0]),n[1]=e[1]+r*(t[1]-e[1]),n[2]=e[2]+r*(t[2]-e[2]),n},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"}},i={create:function(e){var t;return e?((t=new glMatrixArrayType(9))[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8]):t=glMatrixArrayType===Array?new glMatrixArrayType([0,0,0,0,0,0,0,0,0]):new glMatrixArrayType(9),t},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(!t||e==t){var r=e[1],n=e[2],o=e[5];return e[1]=e[3],e[2]=e[6],e[3]=r,e[5]=e[7],e[6]=n,e[7]=o,e}return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},toMat4:function(e,t){return t||(t=u.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"}},u={create:function(e){var t;return e?((t=new glMatrixArrayType(16))[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]):t=glMatrixArrayType===Array?new glMatrixArrayType([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]):new glMatrixArrayType(16),t},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},transpose:function(e,t){if(!t||e==t){var r=e[1],n=e[2],o=e[3],a=e[6],i=e[7],u=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=r,e[6]=e[9],e[7]=e[13],e[8]=n,e[9]=a,e[11]=e[14],e[12]=o,e[13]=i,e[14]=u,e}return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},determinant:function(e){var t=e[0],r=e[1],n=e[2],o=e[3],a=e[4],i=e[5],u=e[6],c=e[7],s=e[8],l=e[9],f=e[10],d=e[11],h=e[12],p=e[13],g=e[14],y=e[15];return h*l*u*o-s*p*u*o-h*i*f*o+a*p*f*o+s*i*g*o-a*l*g*o-h*l*n*c+s*p*n*c+h*r*f*c-t*p*f*c-s*r*g*c+t*l*g*c+h*i*n*d-a*p*n*d-h*r*u*d+t*p*u*d+a*r*g*d-t*i*g*d-s*i*n*y+a*l*n*y+s*r*u*y-t*l*u*y-a*r*f*y+t*i*f*y},inverse:function(e,t){t||(t=e);var r=e[0],n=e[1],o=e[2],a=e[3],i=e[4],u=e[5],c=e[6],s=e[7],l=e[8],f=e[9],d=e[10],h=e[11],p=e[12],g=e[13],y=e[14],m=e[15],v=r*u-n*i,_=r*c-o*i,x=r*s-a*i,w=n*c-o*u,b=n*s-a*u,C=o*s-a*c,E=l*g-f*p,R=l*y-d*p,A=l*m-h*p,T=f*y-d*g,M=f*m-h*g,O=d*m-h*y,S=1/(v*O-_*M+x*T+w*A-b*R+C*E);return t[0]=(u*O-c*M+s*T)*S,t[1]=(-n*O+o*M-a*T)*S,t[2]=(g*C-y*b+m*w)*S,t[3]=(-f*C+d*b-h*w)*S,t[4]=(-i*O+c*A-s*R)*S,t[5]=(r*O-o*A+a*R)*S,t[6]=(-p*C+y*x-m*_)*S,t[7]=(l*C-d*x+h*_)*S,t[8]=(i*M-u*A+s*E)*S,t[9]=(-r*M+n*A-a*E)*S,t[10]=(p*b-g*x+m*v)*S,t[11]=(-l*b+f*x-h*v)*S,t[12]=(-i*T+u*R-c*E)*S,t[13]=(r*T-n*R+o*E)*S,t[14]=(-p*w+g*_-y*v)*S,t[15]=(l*w-f*_+d*v)*S,t},toRotationMat:function(e,t){return t||(t=u.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},toMat3:function(e,t){return t||(t=i.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},toInverseMat3:function(e,t){var r=e[0],n=e[1],o=e[2],a=e[4],u=e[5],c=e[6],s=e[8],l=e[9],f=e[10],d=f*u-c*l,h=-f*a+c*s,p=l*a-u*s,g=r*d+n*h+o*p;if(!g)return null;var y=1/g;return t||(t=i.create()),t[0]=d*y,t[1]=(-f*n+o*l)*y,t[2]=(c*n-o*u)*y,t[3]=h*y,t[4]=(f*r-o*s)*y,t[5]=(-c*r+o*a)*y,t[6]=p*y,t[7]=(-l*r+n*s)*y,t[8]=(u*r-n*a)*y,t},multiply:function(e,t,r){r||(r=e);var n=e[0],o=e[1],a=e[2],i=e[3],u=e[4],c=e[5],s=e[6],l=e[7],f=e[8],d=e[9],h=e[10],p=e[11],g=e[12],y=e[13],m=e[14],v=e[15],_=t[0],x=t[1],w=t[2],b=t[3],C=t[4],E=t[5],R=t[6],A=t[7],T=t[8],M=t[9],O=t[10],S=t[11],D=t[12],z=t[13],I=t[14],P=t[15];return r[0]=_*n+x*u+w*f+b*g,r[1]=_*o+x*c+w*d+b*y,r[2]=_*a+x*s+w*h+b*m,r[3]=_*i+x*l+w*p+b*v,r[4]=C*n+E*u+R*f+A*g,r[5]=C*o+E*c+R*d+A*y,r[6]=C*a+E*s+R*h+A*m,r[7]=C*i+E*l+R*p+A*v,r[8]=T*n+M*u+O*f+S*g,r[9]=T*o+M*c+O*d+S*y,r[10]=T*a+M*s+O*h+S*m,r[11]=T*i+M*l+O*p+S*v,r[12]=D*n+z*u+I*f+P*g,r[13]=D*o+z*c+I*d+P*y,r[14]=D*a+z*s+I*h+P*m,r[15]=D*i+z*l+I*p+P*v,r},multiplyVec3:function(e,t,r){r||(r=t);var n=t[0],o=t[1],a=t[2];return r[0]=e[0]*n+e[4]*o+e[8]*a+e[12],r[1]=e[1]*n+e[5]*o+e[9]*a+e[13],r[2]=e[2]*n+e[6]*o+e[10]*a+e[14],r},multiplyVec4:function(e,t,r){r||(r=t);var n=t[0],o=t[1],a=t[2],i=t[3];return r[0]=e[0]*n+e[4]*o+e[8]*a+e[12]*i,r[1]=e[1]*n+e[5]*o+e[9]*a+e[13]*i,r[2]=e[2]*n+e[6]*o+e[10]*a+e[14]*i,r[3]=e[3]*n+e[7]*o+e[11]*a+e[15]*i,r},translate:function(e,t,r){var n=t[0],o=t[1],a=t[2];if(!r||e==r)return e[12]=e[0]*n+e[4]*o+e[8]*a+e[12],e[13]=e[1]*n+e[5]*o+e[9]*a+e[13],e[14]=e[2]*n+e[6]*o+e[10]*a+e[14],e[15]=e[3]*n+e[7]*o+e[11]*a+e[15],e;var i=e[0],u=e[1],c=e[2],s=e[3],l=e[4],f=e[5],d=e[6],h=e[7],p=e[8],g=e[9],y=e[10],m=e[11];return r[0]=i,r[1]=u,r[2]=c,r[3]=s,r[4]=l,r[5]=f,r[6]=d,r[7]=h,r[8]=p,r[9]=g,r[10]=y,r[11]=m,r[12]=i*n+l*o+p*a+e[12],r[13]=u*n+f*o+g*a+e[13],r[14]=c*n+d*o+y*a+e[14],r[15]=s*n+h*o+m*a+e[15],r},scale:function(e,t,r){var n=t[0],o=t[1],a=t[2];return r&&e!=r?(r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*o,r[5]=e[5]*o,r[6]=e[6]*o,r[7]=e[7]*o,r[8]=e[8]*a,r[9]=e[9]*a,r[10]=e[10]*a,r[11]=e[11]*a,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r):(e[0]*=n,e[1]*=n,e[2]*=n,e[3]*=n,e[4]*=o,e[5]*=o,e[6]*=o,e[7]*=o,e[8]*=a,e[9]*=a,e[10]*=a,e[11]*=a,e)},rotate:function(e,t,r,n){var o=r[0],a=r[1],i=r[2],u=Math.sqrt(o*o+a*a+i*i);if(!u)return null;1!=u&&(o*=u=1/u,a*=u,i*=u);var c=Math.sin(t),s=Math.cos(t),l=1-s,f=e[0],d=e[1],h=e[2],p=e[3],g=e[4],y=e[5],m=e[6],v=e[7],_=e[8],x=e[9],w=e[10],b=e[11],C=o*o*l+s,E=a*o*l+i*c,R=i*o*l-a*c,A=o*a*l-i*c,T=a*a*l+s,M=i*a*l+o*c,O=o*i*l+a*c,S=a*i*l-o*c,D=i*i*l+s;return n?e!=n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=f*C+g*E+_*R,n[1]=d*C+y*E+x*R,n[2]=h*C+m*E+w*R,n[3]=p*C+v*E+b*R,n[4]=f*A+g*T+_*M,n[5]=d*A+y*T+x*M,n[6]=h*A+m*T+w*M,n[7]=p*A+v*T+b*M,n[8]=f*O+g*S+_*D,n[9]=d*O+y*S+x*D,n[10]=h*O+m*S+w*D,n[11]=p*O+v*S+b*D,n},rotateX:function(e,t,r){var n=Math.sin(t),o=Math.cos(t),a=e[4],i=e[5],u=e[6],c=e[7],s=e[8],l=e[9],f=e[10],d=e[11];return r?e!=r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]):r=e,r[4]=a*o+s*n,r[5]=i*o+l*n,r[6]=u*o+f*n,r[7]=c*o+d*n,r[8]=a*-n+s*o,r[9]=i*-n+l*o,r[10]=u*-n+f*o,r[11]=c*-n+d*o,r},rotateY:function(e,t,r){var n=Math.sin(t),o=Math.cos(t),a=e[0],i=e[1],u=e[2],c=e[3],s=e[8],l=e[9],f=e[10],d=e[11];return r?e!=r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]):r=e,r[0]=a*o+s*-n,r[1]=i*o+l*-n,r[2]=u*o+f*-n,r[3]=c*o+d*-n,r[8]=a*n+s*o,r[9]=i*n+l*o,r[10]=u*n+f*o,r[11]=c*n+d*o,r},rotateZ:function(e,t,r){var n=Math.sin(t),o=Math.cos(t),a=e[0],i=e[1],u=e[2],c=e[3],s=e[4],l=e[5],f=e[6],d=e[7];return r?e!=r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]):r=e,r[0]=a*o+s*n,r[1]=i*o+l*n,r[2]=u*o+f*n,r[3]=c*o+d*n,r[4]=a*-n+s*o,r[5]=i*-n+l*o,r[6]=u*-n+f*o,r[7]=c*-n+d*o,r},frustum:function(e,t,r,n,o,a,i){i||(i=u.create());var c=t-e,s=n-r,l=a-o;return i[0]=2*o/c,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*o/s,i[6]=0,i[7]=0,i[8]=(t+e)/c,i[9]=(n+r)/s,i[10]=-(a+o)/l,i[11]=-1,i[12]=0,i[13]=0,i[14]=-a*o*2/l,i[15]=0,i},perspective:function(e,t,r,n,o){var a=r*Math.tan(e*Math.PI/360),i=a*t;return u.frustum(-i,i,-a,a,r,n,o)},ortho:function(e,t,r,n,o,a,i){i||(i=u.create());var c=t-e,s=n-r,l=a-o;return i[0]=2/c,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/s,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-2/l,i[11]=0,i[12]=-(e+t)/c,i[13]=-(n+r)/s,i[14]=-(a+o)/l,i[15]=1,i},lookAt:function(e,t,r,n){n||(n=u.create());var o,a,i,c,s,l,f,d,h,p,g=e[0],y=e[1],m=e[2],v=r[0],_=r[1],x=r[2],w=t[0],b=t[1],C=t[2];return g==w&&y==b&&m==C?u.identity(n):(o=g-t[0],a=y-t[1],i=m-t[2],c=_*(i*=p=1/Math.sqrt(o*o+a*a+i*i))-x*(a*=p),s=x*(o*=p)-v*i,l=v*a-_*o,(p=Math.sqrt(c*c+s*s+l*l))?(c*=p=1/p,s*=p,l*=p):(c=0,s=0,l=0),f=a*l-i*s,d=i*c-o*l,h=o*s-a*c,(p=Math.sqrt(f*f+d*d+h*h))?(f*=p=1/p,d*=p,h*=p):(f=0,d=0,h=0),n[0]=c,n[1]=f,n[2]=o,n[3]=0,n[4]=s,n[5]=d,n[6]=a,n[7]=0,n[8]=l,n[9]=h,n[10]=i,n[11]=0,n[12]=-(c*g+s*y+l*m),n[13]=-(f*g+d*y+h*m),n[14]=-(o*g+a*y+i*m),n[15]=1,n)},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+",\n "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+",\n "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+",\n "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"}};quat4={},quat4.create=function(e){var t;return e?((t=new glMatrixArrayType(4))[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t=glMatrixArrayType===Array?new glMatrixArrayType([0,0,0,0]):new glMatrixArrayType(4),t},quat4.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},quat4.calculateW=function(e,t){var r=e[0],n=e[1],o=e[2];return t&&e!=t?(t[0]=r,t[1]=n,t[2]=o,t[3]=-Math.sqrt(Math.abs(1-r*r-n*n-o*o)),t):(e[3]=-Math.sqrt(Math.abs(1-r*r-n*n-o*o)),e)},quat4.inverse=function(e,t){return t&&e!=t?(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t):(e[0]*=-1,e[1]*=-1,e[2]*=-1,e)},quat4.length=function(e){var t=e[0],r=e[1],n=e[2],o=e[3];return Math.sqrt(t*t+r*r+n*n+o*o)},quat4.normalize=function(e,t){t||(t=e);var r=e[0],n=e[1],o=e[2],a=e[3],i=Math.sqrt(r*r+n*n+o*o+a*a);return 0==i?(t[0]=0,t[1]=0,t[2]=0,t[3]=0,t):(i=1/i,t[0]=r*i,t[1]=n*i,t[2]=o*i,t[3]=a*i,t)},quat4.multiply=function(e,t,r){r||(r=e);var n=e[0],o=e[1],a=e[2],i=e[3],u=t[0],c=t[1],s=t[2],l=t[3];return r[0]=n*l+i*u+o*s-a*c,r[1]=o*l+i*c+a*u-n*s,r[2]=a*l+i*s+n*c-o*u,r[3]=i*l-n*u-o*c-a*s,r},quat4.multiplyVec3=function(e,t,r){r||(r=t);var n=t[0],o=t[1],a=t[2],i=e[0],u=e[1],c=e[2],s=e[3],l=s*n+u*a-c*o,f=s*o+c*n-i*a,d=s*a+i*o-u*n,h=-i*n-u*o-c*a;return r[0]=l*s+h*-i+f*-c-d*-u,r[1]=f*s+h*-u+d*-i-l*-c,r[2]=d*s+h*-c+l*-u-f*-i,r},quat4.toMat3=function(e,t){t||(t=i.create());var r=e[0],n=e[1],o=e[2],a=e[3],u=r+r,c=n+n,s=o+o,l=r*u,f=r*c,d=r*s,h=n*c,p=n*s,g=o*s,y=a*u,m=a*c,v=a*s;return t[0]=1-(h+g),t[1]=f-v,t[2]=d+m,t[3]=f+v,t[4]=1-(l+g),t[5]=p-y,t[6]=d-m,t[7]=p+y,t[8]=1-(l+h),t},quat4.toMat4=function(e,t){t||(t=u.create());var r=e[0],n=e[1],o=e[2],a=e[3],i=r+r,c=n+n,s=o+o,l=r*i,f=r*c,d=r*s,h=n*c,p=n*s,g=o*s,y=a*i,m=a*c,v=a*s;return t[0]=1-(h+g),t[1]=f-v,t[2]=d+m,t[3]=0,t[4]=f+v,t[5]=1-(l+g),t[6]=p-y,t[7]=0,t[8]=d-m,t[9]=p+y,t[10]=1-(l+h),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},quat4.slerp=function(e,t,r,n){n||(n=e);var o=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3];if(Math.abs(o)>=1)return n!=e&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3]),n;var a=Math.acos(o),i=Math.sqrt(1-o*o);if(Math.abs(i)<.001)return n[0]=.5*e[0]+.5*t[0],n[1]=.5*e[1]+.5*t[1],n[2]=.5*e[2]+.5*t[2],n[3]=.5*e[3]+.5*t[3],n;var u=Math.sin((1-r)*a)/i,c=Math.sin(r*a)/i;return n[0]=e[0]*u+t[0]*c,n[1]=e[1]*u+t[1]*c,n[2]=e[2]*u+t[2]*c,n[3]=e[3]*u+t[3]*c,n},quat4.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},n("glMatrix",["typedefs"],function(e){return function(){return e.glMatrix}}(this)),u.xVec4=function(e,t,r){r||(r=t);var n=t[0],o=t[1],a=t[2],i=t[3];return r[0]=e[0]*n+e[1]*o+e[2]*a+e[3]*i,r[1]=e[4]*n+e[5]*o+e[6]*a+e[7]*i,r[2]=e[8]*n+e[9]*o+e[10]*a+e[11]*i,r[3]=e[12]*n+e[13]*o+e[14]*a+e[15]*i,r},i.scale=function(e,t,r){return r&&e!=r?((r=i.create())[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r):(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t,e[8]*=t,e)},i.inverse=function(e,t){t||(t=e);var r=e[0],n=e[1],o=e[2],a=e[3],i=e[4],u=e[5],c=e[6],s=e[7],l=e[8],f=1/(r*i*l+n*u*c+o*a*s-o*i*c-n*a*l-r*u*s);return t[0]=(i*l-u*s)*f,t[1]=(o*s-n*l)*f,t[2]=(n*u-o*i)*f,t[3]=(u*c-a*l)*f,t[4]=(r*l-o*c)*f,t[5]=(o*a-r*u)*f,t[6]=(a*s-i*c)*f,t[7]=(n*c-r*s)*f,t[8]=(r*i-n*a)*f,t},i.multiply=function(e,t,r){r||(r=e);var n=e[0],o=e[1],a=e[2],i=e[3],u=e[4],c=e[5],s=e[6],l=e[7],f=e[8],d=t[0],h=t[1],p=t[2],g=t[3],y=t[4],m=t[5],v=t[6],_=t[7],x=t[8];return r[0]=n*d+o*g+a*v,r[1]=n*h+o*y+a*_,r[2]=n*p+o*m+a*x,r[3]=i*d+u*g+c*v,r[4]=i*h+u*y+c*_,r[5]=i*p+u*m+c*x,r[6]=s*d+l*g+f*v,r[7]=s*h+l*y+f*_,r[8]=s*p+l*m+f*x,r},i.xVec3=function(e,t,r){r||(r=t);var n=t[0],o=t[1],a=t[2];return r[0]=e[0]*n+e[1]*o+e[2]*a,r[1]=e[3]*n+e[4]*o+e[5]*a,r[2]=e[6]*n+e[7]*o+e[8]*a,r};var c={create:function(e){var t;return e?((t=new glMatrixArrayType(4))[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t=glMatrixArrayType===Array?new glMatrixArrayType([0,0,0,0]):new glMatrixArrayType(4),t},xVec2:function(e,t,r){r||(r=t);var n=t[0],o=t[1];return r[0]=e[0]*n+e[1]*o,r[1]=e[2]*n+e[3]*o,r},scale:function(e,t,r){return r&&e!=r?(r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r):(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e)},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},inverse:function(e){var t=1/c.determinant(e),r=e[3]*t,n=-e[1]*t,o=-e[2]*t,a=e[0];return e[0]=r,e[1]=n,e[2]=o,e[3]=a,e}},s={create:function(e){var t;return e?((t=new glMatrixArrayType(2))[0]=e[0],t[1]=e[1]):t=glMatrixArrayType===Array?new glMatrixArrayType([0,0]):new glMatrixArrayType(2),t},subtract:function(e,t,r){return r&&e!=r?(r[0]=e[0]-t[0],r[1]=e[1]-t[1],r):(e[0]-=t[0],e[1]-=t[1],e)},add:function(e,t,r){return r&&e!=r?(r[0]=e[0]+t[0],r[1]=e[1]+t[1],r):(e[0]+=t[0],e[1]+=t[1],e)},scale:function(e,t,r){return r&&e!=r?(r[0]=e[0]*t,r[1]=e[1]*t,r):(e[0]*=t,e[1]*=t,e)},normalize:function(e,t){t||(t=e);var r=e[0],n=e[1],o=Math.sqrt(r*r+n*n);return o?1==o?(t[0]=r,t[1]=n,t):(o=1/o,t[0]=r*o,t[1]=n*o,t):(t[0]=0,t[1]=0,t)},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},multiply:function(e,t,r){return r||(r=e),r[0]=e[0]*t[0],r[1]=e[1]*t[1],r},unproject:function(e){return a.create([e[0],e[1],1])},length:function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},perspectiveProject:function(e){var t=s.create(e);return s.scale(t,1/e[2])}};a.project=function(e){return s.scale(s.create(e),1/e[2])};return i.xVec3=function(e,t,r){r||(r=t);var n=t[0],o=t[1],a=t[2];return r[0]=e[0]*n+e[1]*o+e[2]*a,r[1]=e[3]*n+e[4]*o+e[5]*a,r[2]=e[6]*n+e[7]*o+e[8]*a,r},n("glMatrixAddon",["glMatrix"],function(e){return function(){return e.glMatrixAddon}}(this)),n("array_helper",[],function(){"use strict";return{init:function(e,t){for(var r=e.length;r--;)e[r]=t},shuffle:function(e){for(var t,r,n=e.length-1;n>=0;n--)t=Math.floor(Math.random()*n),r=e[n],e[n]=e[t],e[t]=r;return e},toPointList:function(e){var t,r,n=[],o=[];for(t=0;t<e.length;t++){for(n=[],r=0;r<e[t].length;r++)n[r]=e[t][r];o[t]="["+n.join(",")+"]"}return"["+o.join(",\r\n")+"]"},threshold:function(e,t,r){var n,o=[];for(n=0;n<e.length;n++)r.apply(e,[e[n]])>=t&&o.push(e[n]);return o},maxIndex:function(e){var t,r=0;for(t=0;t<e.length;t++)e[t]>e[r]&&(r=t);return r},max:function(e){var t,r=0;for(t=0;t<e.length;t++)e[t]>r&&(r=e[t]);return r},sum:function(e){for(var t=e.length,r=0;t--;)r+=e[t];return r}}}),n("cv_utils",["cluster","glMatrixAddon","array_helper"],function(e,t,r){"use strict";var n={imageRef:function(e,t){return{x:e,y:t,toVec2:function(){return s.create([this.x,this.y])},toVec3:function(){return a.create([this.x,this.y,1])},round:function(){return this.x=this.x>0?Math.floor(this.x+.5):Math.floor(this.x-.5),this.y=this.y>0?Math.floor(this.y+.5):Math.floor(this.y-.5),this}}},computeIntegralImage2:function(e,t){var r,n,o=e.data,a=e.size.x,i=e.size.y,u=t.data,c=0,s=0,l=0,f=0,d=0;for(l=a,c=0,n=1;n<i;n++)c+=o[s],u[l]+=c,s+=a,l+=a;for(s=0,l=1,c=0,r=1;r<a;r++)c+=o[s],u[l]+=c,s++,l++;for(n=1;n<i;n++)for(s=n*a+1,l=(n-1)*a+1,f=n*a,d=(n-1)*a,r=1;r<a;r++)u[s]+=o[s]+u[l]+u[f]-u[d],s++,l++,f++,d++},computeIntegralImage:function(e,t){for(var r=e.data,n=e.size.x,o=e.size.y,a=t.data,i=0,u=0;u<n;u++)i+=r[u],a[u]=i;for(var c=1;c<o;c++){i=0;for(var s=0;s<n;s++)i+=r[c*n+s],a[c*n+s]=i+a[(c-1)*n+s]}},thresholdImage:function(e,t,r){r||(r=e);for(var n=e.data,o=n.length,a=r.data;o--;)a[o]=n[o]<t?1:0},computeHistogram:function(e,t){t||(t=8);for(var r=e.data,n=r.length,o=8-t,a=new Int32Array(1<<t);n--;)a[r[n]>>o]++;return a},sharpenLine:function(e){var t,r,n=e.length,o=e[0],a=e[1];for(t=1;t<n-1;t++)r=e[t+1],e[t-1]=2*a-o-r&255,o=a,a=r;return e},determineOtsuThreshold:function(e,t){t||(t=8);var o,a=8-t;function i(e,t){var r,n=0;for(r=e;r<=t;r++)n+=o[r];return n}function u(e,t){var r,n=0;for(r=e;r<=t;r++)n+=r*o[r];return n}return function(){var a,c,s,l,f,d=[0],h=(1<<t)-1;for(o=n.computeHistogram(e,t),l=1;l<h;l++)0===(s=(a=i(0,l))*(c=i(l+1,h)))&&(s=1),f=u(0,l)*c-u(l+1,h)*a,d[l]=f*f/s;return r.maxIndex(d)}()<<a},otsuThreshold:function(e,t){var r=n.determineOtsuThreshold(e);return n.thresholdImage(e,r,t),r},computeBinaryImage:function(e,t,r){n.computeIntegralImage(e,t),r||(r=e);var o,a,i,u,c,s,l=e.data,f=r.data,d=e.size.x,h=e.size.y,p=t.data;for(o=0;o<=3;o++)for(a=0;a<d;a++)f[o*d+a]=0,f[(h-1-o)*d+a]=0;for(o=3;o<h-3;o++)for(a=0;a<=3;a++)f[o*d+a]=0,f[o*d+(d-1-a)]=0;for(o=4;o<h-3-1;o++)for(a=4;a<d-3;a++)i=p[(o-3-1)*d+(a-3-1)],u=p[(o-3-1)*d+(a+3)],c=p[(o+3)*d+(a-3-1)],s=(p[(o+3)*d+(a+3)]-c-u+i)/49,f[o*d+a]=l[o*d+a]>s+5?0:1},cluster:function(t,r,n){var o,a,i,u,c=[];function s(e){var t=!1;for(a=0;a<c.length;a++)(i=c[a]).fits(e)&&(i.add(e),t=!0);return t}for(n||(n="rad"),o=0;o<t.length;o++)s(u=e.createPoint(t[o],o,n))||c.push(e.create(u,r));return c}};return n.Tracer={trace:function(e,t){var r,n=[],o=[],a=0,i=0;function u(r,n){var o,a,i,u,c=Math.abs(t[1]/10),s=!1;function l(e,t){return e.x>t.x-1&&e.x<t.x+1&&e.y>t.y-c&&e.y<t.y+c}for(o=e[r],u=n?{x:o.x+t[0],y:o.y+t[1]}:{x:o.x-t[0],y:o.y-t[1]},a=e[i=n?r+1:r-1];a&&!0!==(s=l(a,u))&&Math.abs(a.y-o.y)<t[1];)a=e[i=n?i+1:i-1];return s?i:null}for(r=0;r<10;r++){for(i=a=Math.floor(Math.random()*e.length),(n=[]).push(e[i]);null!==(i=u(i,!0));)n.push(e[i]);if(a>0)for(i=a;null!==(i=u(i,!1));)n.push(e[i]);n.length>o.length&&(o=n)}return o}},n.DILATE=1,n.ERODE=2,n.dilate=function(e,t){var r,n,o,a,i,u,c,s=e.data,l=t.data,f=e.size.y,d=e.size.x;for(r=1;r<f-1;r++)for(n=1;n<d-1;n++)i=r+1,c=n+1,o=s[(a=r-1)*d+(u=n-1)]+s[a*d+c]+s[r*d+n]+s[i*d+u]+s[i*d+c],l[r*d+n]=o>0?1:0},n.erode=function(e,t){var r,n,o,a,i,u,c,s=e.data,l=t.data,f=e.size.y,d=e.size.x;for(r=1;r<f-1;r++)for(n=1;n<d-1;n++)i=r+1,c=n+1,o=s[(a=r-1)*d+(u=n-1)]+s[a*d+c]+s[r*d+n]+s[i*d+u]+s[i*d+c],l[r*d+n]=5===o?1:0},n.subtract=function(e,t,r){r||(r=e);for(var n=e.data.length,o=e.data,a=t.data,i=r.data;n--;)i[n]=o[n]-a[n]},n.bitwiseOr=function(e,t,r){r||(r=e);for(var n=e.data.length,o=e.data,a=t.data,i=r.data;n--;)i[n]=o[n]||a[n]},n.countNonZero=function(e){for(var t=e.data.length,r=e.data,n=0;t--;)n+=r[t];return n},n.topGeneric=function(e,t,r){var n,o,a,i,u=0,c=0,s=[];for(n=0;n<t;n++)s[n]={score:0,item:null};for(n=0;n<e.length;n++)if((o=r.apply(this,[e[n]]))>c)for((a=s[u]).score=o,a.item=e[n],c=Number.MAX_VALUE,i=0;i<t;i++)s[i].score<c&&(c=s[i].score,u=i);return s},n.grayArrayFromImage=function(e,t,r,o){r.drawImage(e,t,0,e.width,e.height);var a=r.getImageData(t,0,e.width,e.height).data;n.computeGray(a,o)},n.grayArrayFromContext=function(e,t,r,o){var a=e.getImageData(r.x,r.y,t.x,t.y).data;n.computeGray(a,o)},n.grayAndHalfSampleFromCanvasData=function(e,t,r){for(var n,o=0,a=t.x,i=Math.floor(e.length/4),u=t.x/2,c=0,s=t.x;a<i;){for(n=0;n<u;n++)r[c]=Math.floor((.299*e[4*o+0]+.587*e[4*o+1]+.114*e[4*o+2]+(.299*e[4*(o+1)+0]+.587*e[4*(o+1)+1]+.114*e[4*(o+1)+2])+(.299*e[4*a+0]+.587*e[4*a+1]+.114*e[4*a+2])+(.299*e[4*(a+1)+0]+.587*e[4*(a+1)+1]+.114*e[4*(a+1)+2]))/4),c++,o+=2,a+=2;o+=s,a+=s}},n.computeGray=function(e,t,r){var n,o=e.length/4|0;if(r&&!0===r.singleChannel)for(n=0;n<o;n++)t[n]=e[4*n+0];else for(n=0;n<o;n++)t[n]=Math.floor(.299*e[4*n+0]+.587*e[4*n+1]+.114*e[4*n+2])},n.loadImageArray=function(e,t,r){r||(r=document.createElement("canvas"));var o=new Image;o.callback=t,o.onload=function(){r.width=this.width,r.height=this.height;var e=r.getContext("2d");e.drawImage(this,0,0);var t=new Uint8Array(this.width*this.height);e.drawImage(this,0,0);var o=e.getImageData(0,0,this.width,this.height).data;n.computeGray(o,t),this.callback(t,{x:this.width,y:this.height},this)},o.src=e},n.halfSample=function(e,t){for(var r=e.data,n=e.size.x,o=t.data,a=0,i=n,u=r.length,c=n/2,s=0;i<u;){for(var l=0;l<c;l++)o[s]=Math.floor((r[a]+r[a+1]+r[i]+r[i+1])/4),s++,a+=2,i+=2;a+=n,i+=n}},n.hsv2rgb=function(e,t){var r=e[0],n=e[1],o=e[2],a=o*n,i=a*(1-Math.abs(r/60%2-1)),u=o-a,c=0,s=0,l=0;return r<60?(c=a,s=i):r<120?(c=i,s=a):r<180?(s=a,l=i):r<240?(s=i,l=a):r<300?(c=i,l=a):r<360&&(c=a,l=i),(t=t||[0,0,0])[0]=255*(c+u)|0,t[1]=255*(s+u)|0,t[2]=255*(l+u)|0,t},n._computeDivisors=function(e){var t,r=[],n=[];for(t=1;t<Math.sqrt(e)+1;t++)e%t===0&&(n.push(t),t!==e/t&&r.unshift(Math.floor(e/t)));return n.concat(r)},n._computeIntersection=function(e,t){for(var r=0,n=0,o=[];r<e.length&&n<t.length;)e[r]===t[n]?(o.push(e[r]),r++,n++):e[r]>t[n]?n++:r++;return o},n.calculatePatchSize=function(e,t){var r,n=this._computeDivisors(t.x),o=this._computeDivisors(t.y),a=Math.max(t.x,t.y),i=this._computeIntersection(n,o),u=[8,10,15,20,32,60,80],c={"x-small":5,small:4,medium:3,large:2,"x-large":1},s=c[e]||c.medium,l=u[s],f=Math.floor(a/l);function d(e){for(var t=0,r=e[Math.floor(e.length/2)];t<e.length-1&&e[t]<f;)t++;return t>0&&(r=Math.abs(e[t]-f)>Math.abs(e[t-1]-f)?e[t-1]:e[t]),f/r<u[s+1]/u[s]&&f/r>u[s-1]/u[s]?{x:r,y:r}:null}return(r=d(i))||(r=d(this._computeDivisors(a)))||(r=d(this._computeDivisors(f*l))),r},n._parseCSSDimensionValues=function(e){return{value:parseFloat(e),unit:(e.indexOf("%"),e.length,"%")}},n._dimensionsConverters={top:function(e,t){if("%"===e.unit)return Math.floor(t.height*(e.value/100))},right:function(e,t){if("%"===e.unit)return Math.floor(t.width-t.width*(e.value/100))},bottom:function(e,t){if("%"===e.unit)return Math.floor(t.height-t.height*(e.value/100))},left:function(e,t){if("%"===e.unit)return Math.floor(t.width*(e.value/100))}},n.computeImageArea=function(e,t,r){var o={width:e,height:t},a=Object.keys(r).reduce(function(e,t){var a=r[t],i=n._parseCSSDimensionValues(a),u=n._dimensionsConverters[t](i,o);return e[t]=u,e},{});return{sx:a.left,sy:a.top,sw:a.right-a.left,sh:a.bottom-a.top}},n}),n("image_wrapper",["subImage","cv_utils","array_helper"],function(e,t,r){"use strict";function n(e,t,n,o){t?this.data=t:n?(this.data=new n(e.x*e.y),n===Array&&o&&r.init(this.data,0)):(this.data=new Uint8Array(e.x*e.y),Uint8Array===Array&&o&&r.init(this.data,0)),this.size=e}return n.prototype.inImageWithBorder=function(e,t){return e.x>=t&&e.y>=t&&e.x<this.size.x-t&&e.y<this.size.y-t},n.transform=function(e,t,r,o,a){var i,u,l,f=t.size.x,d=t.size.y,h=e.size.x,p=e.size.y,g=s.create([r[0],r[2]]),y=s.create([r[1],r[3]]),m=s.subtract(o,c.xVec2(r,a,s.create()),s.create()),v=m[0],_=m[1],x=v,w=_,b=n.sample;g[0]<0?v+=f*g[0]:x+=f*g[0],y[0]<0?v+=d*y[0]:x+=d*y[0],g[1]<0?_+=f*g[1]:w+=f*g[1],y[1]<0?_+=d*y[1]:w+=d*y[1];var C=s.subtract(y,s.scale(g,f,s.create()),s.create());if(v>=0&&_>=0&&x<h-1&&w<p-1){for(i=m,u=0;u<d;++u,s.add(i,C))for(l=0;l<f;++l,s.add(i,g))t.set(l,u,b(e,i[0],i[1]));return 0}var E=h-1,R=p-1,A=0;for(i=m,u=0;u<d;++u,s.add(i,C))for(l=0;l<f;++l,s.add(i,g))0<=i[0]&&0<=i[1]&&i[0]<E&&i[1]<R?t.set(l,u,b(e,i[0],i[1])):(t.set(l,u,0),++A);return A},n.sample=function(e,t,r){var n=Math.floor(t),o=Math.floor(r),a=e.size.x,i=o*e.size.x+n,u=e.data[i+0],c=e.data[i+1],s=e.data[i+a],l=e.data[i+a+1],f=u-c;return t-=n,r-=o,Math.floor(t*(r*(f-s+l)-f)+r*(s-u)+u)},n.clearArray=function(e){for(var t=e.length;t--;)e[t]=0},n.prototype.subImage=function(t,r){return new e(t,r,this)},n.prototype.subImageAsCopy=function(e,t){var r,n,o=e.size.y,a=e.size.x;for(r=0;r<a;r++)for(n=0;n<o;n++)e.data[n*a+r]=this.data[(t.y+n)*this.size.x+t.x+r]},n.prototype.copyTo=function(e){for(var t=this.data.length,r=this.data,n=e.data;t--;)n[t]=r[t]},n.prototype.get=function(e,t){return this.data[t*this.size.x+e]},n.prototype.getSafe=function(e,t){var r;if(!this.indexMapping){for(this.indexMapping={x:[],y:[]},r=0;r<this.size.x;r++)this.indexMapping.x[r]=r,this.indexMapping.x[r+this.size.x]=r;for(r=0;r<this.size.y;r++)this.indexMapping.y[r]=r,this.indexMapping.y[r+this.size.y]=r}return this.data[this.indexMapping.y[t+this.size.y]*this.size.x+this.indexMapping.x[e+this.size.x]]},n.prototype.set=function(e,t,r){return this.data[t*this.size.x+e]=r,this},n.prototype.zeroBorder=function(){var e,t=this.size.x,r=this.size.y,n=this.data;for(e=0;e<t;e++)n[e]=n[(r-1)*t+e]=0;for(e=1;e<r-1;e++)n[e*t]=n[e*t+(t-1)]=0},n.prototype.invert=function(){for(var e=this.data,t=e.length;t--;)e[t]=e[t]?0:1},n.prototype.convolve=function(e){var t,r,n,o,a=e.length/2|0,i=0;for(r=0;r<this.size.y;r++)for(t=0;t<this.size.x;t++){for(i=0,o=-a;o<=a;o++)for(n=-a;n<=a;n++)i+=e[o+a][n+a]*this.getSafe(t+n,r+o);this.data[r*this.size.x+t]=i}},n.prototype.moments=function(e){var t,r,n,o,a,i,u,c,l,f,d=this.data,h=this.size.y,p=this.size.x,g=[],y=[],m=Math.PI,v=m/4;if(e<=0)return y;for(a=0;a<e;a++)g[a]={m00:0,m01:0,m10:0,m11:0,m02:0,m20:0,theta:0,rad:0};for(r=0;r<h;r++)for(o=r*r,t=0;t<p;t++)(n=d[r*p+t])>0&&((i=g[n-1]).m00+=1,i.m01+=r,i.m10+=t,i.m11+=t*r,i.m02+=o,i.m20+=t*t);for(a=0;a<e;a++)i=g[a],isNaN(i.m00)||0===i.m00||(c=i.m10/i.m00,l=i.m01/i.m00,u=i.m11/i.m00-c*l,f=(i.m02/i.m00-l*l-(i.m20/i.m00-c*c))/(2*u),f=.5*Math.atan(f)+(u>=0?v:-v)+m,i.theta=(180*f/m+90)%180-90,i.theta<0&&(i.theta+=180),i.rad=f>m?f-m:f,i.vec=s.create([Math.cos(f),Math.sin(f)]),y.push(i));return y},n.prototype.show=function(e,t){var r,n,o,a,i,u,c;for(t||(t=1),r=e.getContext("2d"),e.width=this.size.x,e.height=this.size.y,o=(n=r.getImageData(0,0,e.width,e.height)).data,a=0,c=0;c<this.size.y;c++)for(u=0;u<this.size.x;u++)i=c*this.size.x+u,a=this.get(u,c)*t,o[4*i+0]=a,o[4*i+1]=a,o[4*i+2]=a,o[4*i+3]=255;r.putImageData(n,0,0)},n.prototype.overlay=function(e,r,n){(!r||r<0||r>360)&&(r=360);for(var o=[0,1,1],a=[0,0,0],i=[255,255,255],u=[0,0,0],c=[],s=e.getContext("2d"),l=s.getImageData(n.x,n.y,this.size.x,this.size.y),f=l.data,d=this.data.length;d--;)o[0]=this.data[d]*r,c=o[0]<=0?i:o[0]>=360?u:t.hsv2rgb(o,a),f[4*d+0]=c[0],f[4*d+1]=c[1],f[4*d+2]=c[2],f[4*d+3]=255;s.putImageData(l,n.x,n.y)},n}),n("tracer",[],function(){"use strict";return{searchDirections:[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],create:function(e,t){var r,n=e.data,o=t.data,a=this.searchDirections,i=e.size.x;function u(e,t,u,c){var s,l,f;for(s=0;s<7;s++){if(l=e.cy+a[e.dir][0],f=e.cx+a[e.dir][1],n[r=l*i+f]===t&&(0===o[r]||o[r]===u))return o[r]=u,e.cy=l,e.cx=f,!0;0===o[r]&&(o[r]=c),e.dir=(e.dir+1)%8}return!1}function c(e,t,r){return{dir:r,x:e,y:t,next:null,prev:null}}return{trace:function(e,t,r,n){return u(e,t,r,n)},contourTracing:function(e,t,r,n,o){return function(e,t,r,n,o){var a,i,s,l=null,f={cx:t,cy:e,dir:0};if(u(f,n,r,o)){a=l=c(t,e,f.dir),s=f.dir,(i=c(f.cx,f.cy,0)).prev=a,a.next=i,i.next=null,a=i;do{f.dir=(f.dir+6)%8,u(f,n,r,o),s!=f.dir?(a.dir=f.dir,(i=c(f.cx,f.cy,0)).prev=a,a.next=i,i.next=null,a=i):(a.dir=s,a.x=f.cx,a.y=f.cy),s=f.dir}while(f.cx!=t||f.cy!=e);l.prev=a.prev,a.prev.next=l}return l}(e,t,r,n,o)}}}}}),n("rasterizer",["tracer"],function(e){"use strict";var t={createContour2D:function(){return{dir:null,index:null,firstVertex:null,insideContours:null,nextpeer:null,prevpeer:null}},CONTOUR_DIR:{CW_DIR:0,CCW_DIR:1,UNKNOWN_DIR:2},DIR:{OUTSIDE_EDGE:-32767,INSIDE_EDGE:-32766},create:function(r,n){var o=r.data,a=n.data,i=r.size.x,u=r.size.y,c=e.create(r,n);return{rasterize:function(e){var r,n,s,l,f,d,h,p,g,y,m,v,_=[],x=0;for(v=0;v<400;v++)_[v]=0;for(_[0]=o[0],g=null,d=1;d<u-1;d++)for(l=0,n=_[0],f=1;f<i-1;f++)if(0===a[m=d*i+f])if((r=o[m])!==n){if(0===l)_[s=x+1]=r,n=r,null!==(h=c.contourTracing(d,f,s,r,t.DIR.OUTSIDE_EDGE))&&(x++,l=s,(p=t.createContour2D()).dir=t.CONTOUR_DIR.CW_DIR,p.index=l,p.firstVertex=h,p.nextpeer=g,p.insideContours=null,null!==g&&(g.prevpeer=p),g=p);else if(null!==(h=c.contourTracing(d,f,t.DIR.INSIDE_EDGE,r,l))){for((p=t.createContour2D()).firstVertex=h,p.insideContours=null,p.dir=0===e?t.CONTOUR_DIR.CCW_DIR:t.CONTOUR_DIR.CW_DIR,p.index=e,y=g;null!==y&&y.index!==l;)y=y.nextpeer;null!==y&&(p.nextpeer=y.insideContours,null!==y.insideContours&&(y.insideContours.prevpeer=p),y.insideContours=p)}}else a[m]=l;else a[m]===t.DIR.OUTSIDE_EDGE||a[m]===t.DIR.INSIDE_EDGE?(l=0,n=a[m]===t.DIR.INSIDE_EDGE?o[m]:_[0]):n=_[l=a[m]];for(y=g;null!==y;)y.index=e,y=y.nextpeer;return{cc:g,count:x}},debug:{drawContour:function(e,r){var n,o,a,i=e.getContext("2d"),u=r;for(i.strokeStyle="red",i.fillStyle="red",i.lineWidth=1,n=null!==u?u.insideContours:null;null!==u;){switch(null!==n?(o=n,n=n.nextpeer):(o=u,n=null!==(u=u.nextpeer)?u.insideContours:null),o.dir){case t.CONTOUR_DIR.CW_DIR:i.strokeStyle="red";break;case t.CONTOUR_DIR.CCW_DIR:i.strokeStyle="blue";break;case t.CONTOUR_DIR.UNKNOWN_DIR:i.strokeStyle="green"}a=o.firstVertex,i.beginPath(),i.moveTo(a.x,a.y);do{a=a.next,i.lineTo(a.x,a.y)}while(a!==o.firstVertex);i.stroke()}}}}}};return t}),n("skeletonizer",[],function(){"use strict";return function(e,t,r){"use asm";var n=new e.Uint8Array(r),o=t.size|0,a=e.Math.imul;function i(e,t){e=e|0;t=t|0;var r=0,a=0,i=0,u=0,c=0,s=0,l=0,f=0;for(r=1;(r|0)<(o-1|0);r=r+1|0){f=f+o|0;for(a=1;(a|0)<(o-1|0);a=a+1|0){u=f-o|0;c=f+o|0;s=a-1|0;l=a+1|0;i=(n[e+u+s|0]|0)+(n[e+u+l|0]|0)+(n[e+f+a|0]|0)+(n[e+c+s|0]|0)+(n[e+c+l|0]|0)|0;if((i|0)==(5|0)){n[t+f+a|0]=1}else{n[t+f+a|0]=0}}}return}function u(e,t,r){e=e|0;t=t|0;r=r|0;var i=0;i=a(o,o)|0;while((i|0)>0){i=i-1|0;n[r+i|0]=(n[e+i|0]|0)-(n[t+i|0]|0)|0}}function c(e,t,r){e=e|0;t=t|0;r=r|0;var i=0;i=a(o,o)|0;while((i|0)>0){i=i-1|0;n[r+i|0]=n[e+i|0]|0|(n[t+i|0]|0)|0}}function s(e){e=e|0;var t=0,r=0;r=a(o,o)|0;while((r|0)>0){r=r-1|0;t=(t|0)+(n[e+r|0]|0)|0}return t|0}function l(e,t){e=e|0;t=t|0;var r=0;r=a(o,o)|0;while((r|0)>0){r=r-1|0;n[e+r|0]=t}}function f(e,t){e=e|0;t=t|0;var r=0,a=0,i=0,u=0,c=0,s=0,l=0,f=0;for(r=1;(r|0)<(o-1|0);r=r+1|0){f=f+o|0;for(a=1;(a|0)<(o-1|0);a=a+1|0){u=f-o|0;c=f+o|0;s=a-1|0;l=a+1|0;i=(n[e+u+s|0]|0)+(n[e+u+l|0]|0)+(n[e+f+a|0]|0)+(n[e+c+s|0]|0)+(n[e+c+l|0]|0)|0;if((i|0)>(0|0)){n[t+f+a|0]=1}else{n[t+f+a|0]=0}}}return}function d(e,t){e=e|0;t=t|0;var r=0;r=a(o,o)|0;while((r|0)>0){r=r-1|0;n[t+r|0]=n[e+r|0]|0}}function h(e){e=e|0;var t=0,r=0;for(t=0;(t|0)<(o-1|0);t=t+1|0){n[e+t|0]=0;n[e+r|0]=0;r=r+o-1|0;n[e+r|0]=0;r=r+1|0}for(t=0;(t|0)<(o|0);t=t+1|0){n[e+r|0]=0;r=r+1|0}}function p(){var e=0,t=0,r=0,n=0,p=0,g=0;t=a(o,o)|0;r=t+t|0;n=r+t|0;l(n,0);h(e);do{i(e,t);f(t,r);u(e,r,r);c(n,r,n);d(t,e);p=s(e)|0;g=(p|0)==0|0}while(!g)}return{skeletonize:p}}}),n("image_debug",[],function(){"use strict";return{drawRect:function(e,t,r,n){r.strokeStyle=n.color,r.fillStyle=n.color,r.lineWidth=1,r.beginPath(),r.strokeRect(e.x,e.y,t.x,t.y)},drawPath:function(e,t,r,n){r.strokeStyle=n.color,r.fillStyle=n.color,r.lineWidth=n.lineWidth,r.beginPath(),r.moveTo(e[0][t.x],e[0][t.y]);for(var o=1;o<e.length;o++)r.lineTo(e[o][t.x],e[o][t.y]);r.closePath(),r.stroke()},drawImage:function(e,t,r){var n,o=r.getImageData(0,0,t.x,t.y),a=o.data,i=e.length,u=a.length;if(u/i!==4)return!1;for(;i--;)n=e[i],a[--u]=255,a[--u]=n,a[--u]=n,a[--u]=n;return r.putImageData(o,0,0),!0}}}),n("barcode_locator",["image_wrapper","cv_utils","rasterizer","tracer","skeletonizer","array_helper","image_debug"],function(e,t,r,n,o,a,i){var u,l,f,d,h,p,g,y,m,v,_,x,w={ctx:{binary:null},dom:{binary:null}},b={x:0,y:0},C=this;function E(e){var t,r,n,o,a,l,f,h=m.size.x,p=m.size.y,g=-m.size.x,y=-m.size.y;for(t=0,r=0;r<e.length;r++)t+=(o=e[r]).rad,u.showPatches&&i.drawRect(o.pos,d.size,w.ctx.binary,{color:"red"});for((t=(180*(t/=e.length)/Math.PI+90)%180-90)<0&&(t+=180),t=(180-t)*Math.PI/180,a=c.create([Math.cos(t),-Math.sin(t),Math.sin(t),Math.cos(t)]),r=0;r<e.length;r++){for(o=e[r],n=0;n<4;n++)c.xVec2(a,o.box[n]);u.boxFromPatches.showTransformed&&i.drawPath(o.box,{x:0,y:1},w.ctx.binary,{color:"#99ff00",lineWidth:2})}for(r=0;r<e.length;r++)for(o=e[r],n=0;n<4;n++)o.box[n][0]<h&&(h=o.box[n][0]),o.box[n][0]>g&&(g=o.box[n][0]),o.box[n][1]<p&&(p=o.box[n][1]),o.box[n][1]>y&&(y=o.box[n][1]);for(l=[[h,p],[g,p],[g,y],[h,y]],u.boxFromPatches.showTransformedBox&&i.drawPath(l,{x:0,y:1},w.ctx.binary,{color:"#ff0000",lineWidth:2}),f=u.halfSample?2:1,a=c.inverse(a),n=0;n<4;n++)c.xVec2(a,l[n]);for(u.boxFromPatches.showBB&&i.drawPath(l,{x:0,y:1},w.ctx.binary,{color:"#ff0000",lineWidth:2}),n=0;n<4;n++)s.scale(l[n],f);return l}function R(e,r){m.subImageAsCopy(d,t.imageRef(e,r)),x.skeletonize(),u.showSkeleton&&f.overlay(w.dom.binary,360,t.imageRef(e,r))}function A(e,r,n,o){var a,i,u,c,l=[],f=[],h=Math.ceil(v.x/3);if(e.length>=2){for(a=0;a<e.length;a++)e[a].m00>h&&l.push(e[a]);if(l.length>=2){for(l.length,u=function(e){var r=t.cluster(e,.9),n=t.topGeneric(r,1,function(e){return e.getPoints().length}),o=[],a=[];if(1===n.length){o=n[0].item.getPoints();for(var i=0;i<o.length;i++)a.push(o[i].point)}return a}(l),i=0,a=0;a<u.length;a++)i+=u[a].rad;u.length>1&&u.length>=l.length/4*3&&u.length>e.length/4&&(i/=u.length,c={index:r[1]*b.x+r[0],pos:{x:n,y:o},box:[s.create([n,o]),s.create([n+d.size.x,o]),s.create([n+d.size.x,o+d.size.y]),s.create([n,o+d.size.y])],moments:u,rad:i,vec:s.create([Math.cos(i),Math.sin(i)])},f.push(c))}}return f}return{init:function(r,n){u=n,_=r,function(){var r;l=u.halfSample?new e({x:_.size.x/2|0,y:_.size.y/2|0}):_,v=t.calculatePatchSize(u.patchSize,l.size),b.x=l.size.x/v.x|0,b.y=l.size.y/v.y|0,m=new e(l.size,void 0,Uint8Array,!1),h=new e(v,void 0,Array,!0),r=new ArrayBuffer(65536),d=new e(v,new Uint8Array(r,0,v.x*v.y)),f=new e(v,new Uint8Array(r,v.x*v.y*3,v.x*v.y),void 0,!0),x=o(C,{size:v.x},r),y=new e({x:l.size.x/d.size.x|0,y:l.size.y/d.size.y|0},void 0,Array,!0),p=new e(y.size,void 0,void 0,!0),g=new e(y.size,void 0,Int32Array,!0)}(),u.useWorker||"undefined"===typeof document||(w.dom.binary=document.createElement("canvas"),w.dom.binary.className="binaryBuffer",!0===u.showCanvas&&document.querySelector("#debug").appendChild(w.dom.binary),w.ctx.binary=w.dom.binary.getContext("2d"),w.dom.binary.width=m.size.x,w.dom.binary.height=m.size.y)},locate:function(){var e,o,c;if(u.halfSample&&t.halfSample(_,l),t.otsuThreshold(l,m),m.zeroBorder(),u.showCanvas&&m.show(w.dom.binary,255),(e=function(){var e,t,n,o,c,s,l,p=[];for(e=0;e<b.x;e++)for(t=0;t<b.y;t++)R(n=d.size.x*e,o=d.size.y*t),f.zeroBorder(),a.init(h.data,0),s=r.create(f,h).rasterize(0),u.showLabels&&h.overlay(w.dom.binary,Math.floor(360/s.count),{x:n,y:o}),c=h.moments(s.count),p=p.concat(A(c,[e,t],n,o));if(u.showFoundPatches)for(e=0;e<p.length;e++)l=p[e],i.drawRect(l.pos,d.size,w.ctx.binary,{color:"#99ff00",lineWidth:2});return p}()).length<b.x*b.y*.05)return null;var v=function(e){var r,o,c=0,l=0,f=[0,1,1],h=[0,0,0];function m(){var e;for(e=0;e<g.data.length;e++)if(0===g.data[e]&&1===p.data[e])return e;return g.length}function v(e){var t,r,o,a,i,u,l=e%g.size.x,f=e/g.size.x|0;if(e<g.data.length)for(o=y.data[e],g.data[e]=c,u=0;u<n.searchDirections.length;u++)r=f+n.searchDirections[u][0],t=l+n.searchDirections[u][1],i=r*g.size.x+t,0!==p.data[i]?(a=y.data[i],0===g.data[i]&&Math.abs(s.dot(a.vec,o.vec))>.95&&v(i)):g.data[i]=Number.MAX_VALUE}for(a.init(p.data,0),a.init(g.data,0),a.init(y.data,null),r=0;r<e.length;r++)o=e[r],y.data[o.index]=o,p.data[o.index]=1;for(p.zeroBorder();(l=m())<g.data.length;)c++,v(l);if(u.showPatchLabels)for(r=0;r<g.data.length;r++)g.data[r]>0&&g.data[r]<=c&&(o=y.data[r],f[0]=g.data[r]/(c+1)*360,t.hsv2rgb(f,h),i.drawRect(o.pos,d.size,w.ctx.binary,{color:"rgb("+h.join(",")+")",lineWidth:2}));return c}(e);return v<1?null:(o=function(e){var t,r,n=[];for(t=0;t<e;t++)n.push(0);for(r=g.data.length;r--;)g.data[r]>0&&n[g.data[r]-1]++;return(n=n.map(function(e,t){return{val:e,label:t+1}})).sort(function(e,t){return t.val-e.val}),n.filter(function(e){return e.val>=5})}(v),0===o.length?null:(c=function(e,r){var n,o,a,c,s,l=[],f=[],h=[0,1,1],p=[0,0,0];for(n=0;n<e.length;n++){for(a=g.data.length,l.length=0;a--;)g.data[a]===e[n].label&&(c=y.data[a],l.push(c));if((s=E(l))&&(f.push(s),u.showRemainingPatchLabels))for(o=0;o<l.length;o++)c=l[o],h[0]=e[n].label/(r+1)*360,t.hsv2rgb(h,p),i.drawRect(c.pos,d.size,w.ctx.binary,{color:"rgb("+p.join(",")+")",lineWidth:2})}return f}(o,v),c))},checkImageConstraints:function(e,r){var n,o,a,i=e.getWidth(),u=e.getHeight(),c=r.halfSample?.5:1;if(e.getConfig().area&&(a=t.computeImageArea(i,u,e.getConfig().area),e.setTopRight({x:a.sx,y:a.sy}),e.setCanvasSize({x:i,y:u}),i=a.sw,u=a.sh),o={x:Math.floor(i*c),y:Math.floor(u*c)},n=t.calculatePatchSize(r.patchSize,o),console.log("Patch-Size: "+JSON.stringify(n)),e.setWidth(Math.floor(Math.floor(o.x/n.x)*(1/c)*n.x)),e.setHeight(Math.floor(Math.floor(o.y/n.y)*(1/c)*n.y)),e.getWidth()%n.x===0&&e.getHeight()%n.y===0)return!0;throw new Error("Image dimensions do not comply with the current settings: Width ("+i+" )and height ("+u+") must a multiple of "+n.x)}}}),n("bresenham",["cv_utils","image_wrapper"],function(e,t){"use strict";var r={},n={UP:1,DOWN:-1};return r.getBarcodeLine=function(e,t,r){var n,o,a,i,u,c,s,l,f=0|t.x,d=0|t.y,h=0|r.x,p=0|r.y,g=Math.abs(p-d)>Math.abs(h-f),y=[],m=e.data,v=e.size.x,_=255,x=0;function w(e,t){l=m[t*v+e],_=l<_?l:_,x=l>x?l:x,y.push(l)}for(g&&(c=f,f=d,d=c,c=h,h=p,p=c),f>h&&(c=f,f=h,h=c,c=d,d=p,p=c),n=h-f,o=Math.abs(p-d),a=n/2|0,u=d,i=d<p?1:-1,s=f;s<h;s++)g?w(u,s):w(s,u),(a-=o)<0&&(u+=i,a+=n);return{line:y,min:_,max:x}},r.toOtsuBinaryLine=function(r){var n=r.line,o=new t({x:n.length-1,y:1},n),a=e.determineOtsuThreshold(o,5);return n=e.sharpenLine(n),e.thresholdImage(o,a),{line:n,threshold:a}},r.toBinaryLine=function(e){var t,r,o,a,i,u,c=e.min,s=e.max,l=e.line,f=c+(s-c)/2,d=[],h=(s-c)/12,p=-h;for(o=l[0]>f?n.UP:n.DOWN,d.push({pos:0,val:l[0]}),i=0;i<l.length-2;i++)o!==(a=(t=l[i+1]-l[i])+(r=l[i+2]-l[i+1])<p&&l[i+1]<1.5*f?n.DOWN:t+r>h&&l[i+1]>.5*f?n.UP:o)&&(d.push({pos:i,val:l[i]}),o=a);for(d.push({pos:l.length,val:l[l.length-1]}),u=d[0].pos;u<d[1].pos;u++)l[u]=l[u]>f?0:1;for(i=1;i<d.length-1;i++)for(h=d[i+1].val>d[i].val?d[i].val+(d[i+1].val-d[i].val)/3*2|0:d[i+1].val+(d[i].val-d[i+1].val)/3|0,u=d[i].pos;u<d[i+1].pos;u++)l[u]=l[u]>h?0:1;return{line:l,threshold:h}},r.debug={printFrequency:function(e,t){var r,n=t.getContext("2d");for(t.width=e.length,t.height=256,n.beginPath(),n.strokeStyle="blue",r=0;r<e.length;r++)n.moveTo(r,255),n.lineTo(r,255-e[r]);n.stroke(),n.closePath()},printPattern:function(e,t){var r,n=t.getContext("2d");for(t.width=e.length,n.fillColor="black",r=0;r<e.length;r++)1===e[r]&&n.fillRect(r,0,1,100)}},r}),n("barcode_reader",[],function(){"use strict";function e(e){return this._row=[],this.config=e||{},this}return e.prototype._nextUnset=function(e,t){var r;for(void 0===t&&(t=0),r=t;r<e.length;r++)if(!e[r])return r;return e.length},e.prototype._matchPattern=function(e,t){var r,n=0,o=0,a=this.MODULO,i=this.SINGLE_CODE_ERROR||1;for(r=0;r<e.length;r++){if((o=Math.abs(t[r]-e[r]))>i)return Number.MAX_VALUE;n+=o}return n/a},e.prototype._nextSet=function(e,t){var r;for(r=t=t||0;r<e.length;r++)if(e[r])return r;return e.length},e.prototype._normalize=function(e,t){var r,n,o=0,a=0,i=[],u=0;for(t||(t=this.MODULO),r=0;r<e.length;r++)1===e[r]?a++:o+=e[r];if((n=o/(t-a))>1)for(r=0;r<e.length;r++)u=1===e[r]?e[r]:e[r]/n,i.push(u);else for(n=(o+a)/t,r=0;r<e.length;r++)u=e[r]/n,i.push(u);return i},e.prototype._matchTrace=function(e,t){var r,n=[],o=this,a=o._nextSet(o._row),i=!o._row[a],u=0,c={error:Number.MAX_VALUE,code:-1,start:0};if(e){for(r=0;r<e.length;r++)n.push(0);for(r=a;r<o._row.length;r++)if(o._row[r]^i)n[u]++;else{if(u===n.length-1)return o._matchPattern(n,e)<t?(c.start=r-a,c.end=r,c.counter=n,c):null;n[++u]=1,i=!i}}else for(n.push(0),r=a;r<o._row.length;r++)o._row[r]^i?n[u]++:(u++,n.push(0),n[u]=1,i=!i);return c.start=a,c.end=o._row.length-1,c.counter=n,c},e.prototype.decodePattern=function(t){var r,n=this;return n._row=t,null===(r=n._decode())?(n._row.reverse(),(r=n._decode())&&(r.direction=e.DIRECTION.REVERSE,r.start=n._row.length-r.start,r.end=n._row.length-r.end)):r.direction=e.DIRECTION.FORWARD,r&&(r.format=n.FORMAT),r},e.prototype._matchRange=function(e,t,r){var n;for(n=e=e<0?0:e;n<t;n++)if(this._row[n]!==r)return!1;return!0},e.prototype._fillCounters=function(e,t,r){var n,o=this,a=0,i=[];for(r="undefined"===typeof r||r,e="undefined"!==typeof e?e:o._nextUnset(o._row),t=t||o._row.length,i[a]=0,n=e;n<t;n++)o._row[n]^r?i[a]++:(i[++a]=1,r=!r);return i},Object.defineProperty(e.prototype,"FORMAT",{value:"unknown",writeable:!1}),e.DIRECTION={FORWARD:1,REVERSE:-1},e.Exception={StartNotFoundException:"Start-Info was not found!",CodeNotFoundException:"Code could not be found!",PatternNotFoundException:"Pattern could not be found!"},e.CONFIG_KEYS={},e}),n("code_128_reader",["./barcode_reader"],function(e){"use strict";function t(){e.call(this)}return t.prototype=Object.create(e.prototype,{CODE_SHIFT:{value:98},CODE_C:{value:99},CODE_B:{value:100},CODE_A:{value:101},START_CODE_A:{value:103},START_CODE_B:{value:104},START_CODE_C:{value:105},STOP_CODE:{value:106},MODULO:{value:11},CODE_PATTERN:{value:[[2,1,2,2,2,2],[2,2,2,1,2,2],[2,2,2,2,2,1],[1,2,1,2,2,3],[1,2,1,3,2,2],[1,3,1,2,2,2],[1,2,2,2,1,3],[1,2,2,3,1,2],[1,3,2,2,1,2],[2,2,1,2,1,3],[2,2,1,3,1,2],[2,3,1,2,1,2],[1,1,2,2,3,2],[1,2,2,1,3,2],[1,2,2,2,3,1],[1,1,3,2,2,2],[1,2,3,1,2,2],[1,2,3,2,2,1],[2,2,3,2,1,1],[2,2,1,1,3,2],[2,2,1,2,3,1],[2,1,3,2,1,2],[2,2,3,1,1,2],[3,1,2,1,3,1],[3,1,1,2,2,2],[3,2,1,1,2,2],[3,2,1,2,2,1],[3,1,2,2,1,2],[3,2,2,1,1,2],[3,2,2,2,1,1],[2,1,2,1,2,3],[2,1,2,3,2,1],[2,3,2,1,2,1],[1,1,1,3,2,3],[1,3,1,1,2,3],[1,3,1,3,2,1],[1,1,2,3,1,3],[1,3,2,1,1,3],[1,3,2,3,1,1],[2,1,1,3,1,3],[2,3,1,1,1,3],[2,3,1,3,1,1],[1,1,2,1,3,3],[1,1,2,3,3,1],[1,3,2,1,3,1],[1,1,3,1,2,3],[1,1,3,3,2,1],[1,3,3,1,2,1],[3,1,3,1,2,1],[2,1,1,3,3,1],[2,3,1,1,3,1],[2,1,3,1,1,3],[2,1,3,3,1,1],[2,1,3,1,3,1],[3,1,1,1,2,3],[3,1,1,3,2,1],[3,3,1,1,2,1],[3,1,2,1,1,3],[3,1,2,3,1,1],[3,3,2,1,1,1],[3,1,4,1,1,1],[2,2,1,4,1,1],[4,3,1,1,1,1],[1,1,1,2,2,4],[1,1,1,4,2,2],[1,2,1,1,2,4],[1,2,1,4,2,1],[1,4,1,1,2,2],[1,4,1,2,2,1],[1,1,2,2,1,4],[1,1,2,4,1,2],[1,2,2,1,1,4],[1,2,2,4,1,1],[1,4,2,1,1,2],[1,4,2,2,1,1],[2,4,1,2,1,1],[2,2,1,1,1,4],[4,1,3,1,1,1],[2,4,1,1,1,2],[1,3,4,1,1,1],[1,1,1,2,4,2],[1,2,1,1,4,2],[1,2,1,2,4,1],[1,1,4,2,1,2],[1,2,4,1,1,2],[1,2,4,2,1,1],[4,1,1,2,1,2],[4,2,1,1,1,2],[4,2,1,2,1,1],[2,1,2,1,4,1],[2,1,4,1,2,1],[4,1,2,1,2,1],[1,1,1,1,4,3],[1,1,1,3,4,1],[1,3,1,1,4,1],[1,1,4,1,1,3],[1,1,4,3,1,1],[4,1,1,1,1,3],[4,1,1,3,1,1],[1,1,3,1,4,1],[1,1,4,1,3,1],[3,1,1,1,4,1],[4,1,1,1,3,1],[2,1,1,4,1,2],[2,1,1,2,1,4],[2,1,1,2,3,2],[2,3,3,1,1,1,2]]},SINGLE_CODE_ERROR:{value:1},AVG_CODE_ERROR:{value:.5},FORMAT:{value:"code_128",writeable:!1}}),t.prototype.constructor=t,t.prototype._decodeCode=function(e){var t,r,n,o,a=[0,0,0,0,0,0],i=this,u=e,c=!i._row[u],s=0,l={error:Number.MAX_VALUE,code:-1,start:e,end:e};for(t=u;t<i._row.length;t++)if(i._row[t]^c)a[s]++;else{if(s===a.length-1){if(o=i._normalize(a)){for(r=0;r<i.CODE_PATTERN.length;r++)(n=i._matchPattern(o,i.CODE_PATTERN[r]))<l.error&&(l.code=r,l.error=n);return l.end=t,l}}else s++;a[s]=1,c=!c}return null},t.prototype._findStart=function(){var e,t,r,n,o,a,i=[0,0,0,0,0,0],u=this,c=u._nextSet(u._row),s=!1,l=0,f={error:Number.MAX_VALUE,code:-1,start:0,end:0};for(e=c;e<u._row.length;e++)if(u._row[e]^s)i[l]++;else{if(l===i.length-1){for(o=0,n=0;n<i.length;n++)o+=i[n];if(a=u._normalize(i)){for(t=u.START_CODE_A;t<=u.START_CODE_C;t++)(r=u._matchPattern(a,u.CODE_PATTERN[t]))<f.error&&(f.code=t,f.error=r);if(f.error<u.AVG_CODE_ERROR)return f.start=e-o,f.end=e,f}for(n=0;n<4;n++)i[n]=i[n+2];i[4]=0,i[5]=0,l--}else l++;i[l]=1,s=!s}return null},t.prototype._decode=function(){var e,t,r=this,n=r._findStart(),o=null,a=!1,i=[],u=0,c=0,s=[],l=[],f=!1;if(null===n)return null;switch(o={code:n.code,start:n.start,end:n.end},l.push(o),c=o.code,o.code){case r.START_CODE_A:e=r.CODE_A;break;case r.START_CODE_B:e=r.CODE_B;break;case r.START_CODE_C:e=r.CODE_C;break;default:return null}for(;!a;){if(t=f,f=!1,null!==(o=r._decodeCode(o.end)))switch(o.code!==r.STOP_CODE&&(s.push(o.code),c+=++u*o.code),l.push(o),e){case r.CODE_A:if(o.code<64)i.push(String.fromCharCode(32+o.code));else if(o.code<96)i.push(String.fromCharCode(o.code-64));else switch(o.code){case r.CODE_SHIFT:f=!0,e=r.CODE_B;break;case r.CODE_B:e=r.CODE_B;break;case r.CODE_C:e=r.CODE_C;break;case r.STOP_CODE:a=!0}break;case r.CODE_B:if(o.code<96)i.push(String.fromCharCode(32+o.code));else switch(o.code!=r.STOP_CODE&&!1,o.code){case r.CODE_SHIFT:f=!0,e=r.CODE_A;break;case r.CODE_A:e=r.CODE_A;break;case r.CODE_C:e=r.CODE_C;break;case r.STOP_CODE:a=!0}break;case r.CODE_C:switch(o.code<100&&i.push(o.code<10?"0"+o.code:o.code),o.code){case r.CODE_A:e=r.CODE_A;break;case r.CODE_B:e=r.CODE_B;break;case r.STOP_CODE:a=!0}}else a=!0;t&&(e=e==r.CODE_A?r.CODE_B:r.CODE_A)}return null===o?null:(o.end=r._nextUnset(r._row,o.end),r._verifyTrailingWhitespace(o)?(c-=u*s[s.length-1])%103!=s[s.length-1]?null:i.length?(i.splice(i.length-1,1),{code:i.join(""),start:n.start,end:o.end,codeset:e,startInfo:n,decodedCodes:l,endInfo:o}):null:null)},e.prototype._verifyTrailingWhitespace=function(e){var t;return(t=e.end+(e.end-e.start)/2)<this._row.length&&this._matchRange(e.end,t,0)?e:null},t}),n("ean_reader",["./barcode_reader"],function(e){"use strict";function t(t){e.call(this,t)}return t.prototype=Object.create(e.prototype,{CODE_L_START:{value:0},MODULO:{value:7},CODE_G_START:{value:10},START_PATTERN:{value:[1/3*7,1/3*7,1/3*7]},STOP_PATTERN:{value:[1/3*7,1/3*7,1/3*7]},MIDDLE_PATTERN:{value:[.2*7,.2*7,.2*7,.2*7,.2*7]},CODE_PATTERN:{value:[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2],[1,1,2,3],[1,2,2,2],[2,2,1,2],[1,1,4,1],[2,3,1,1],[1,3,2,1],[4,1,1,1],[2,1,3,1],[3,1,2,1],[2,1,1,3]]},CODE_FREQUENCY:{value:[0,11,13,14,19,25,28,21,22,26]},SINGLE_CODE_ERROR:{value:.67},AVG_CODE_ERROR:{value:.27},FORMAT:{value:"ean_13",writeable:!1}}),t.prototype.constructor=t,t.prototype._decodeCode=function(e,t){var r,n,o,a,i=[0,0,0,0],u=this,c=e,s=!u._row[c],l=0,f={error:Number.MAX_VALUE,code:-1,start:e,end:e};for(t||(t=u.CODE_PATTERN.length),r=c;r<u._row.length;r++)if(u._row[r]^s)i[l]++;else{if(l===i.length-1){if(a=u._normalize(i)){for(n=0;n<t;n++)(o=u._matchPattern(a,u.CODE_PATTERN[n]))<f.error&&(f.code=n,f.error=o);return f.end=r,f.error>u.AVG_CODE_ERROR?null:f}}else l++;i[l]=1,s=!s}return null},t.prototype._findPattern=function(e,t,r,n,o){var a,i,u,c,s,l=[],f=this,d=0,h={error:Number.MAX_VALUE,code:-1,start:0,end:0};for(t||(t=f._nextSet(f._row)),void 0===r&&(r=!1),void 0===n&&(n=!0),void 0===o&&(o=f.AVG_CODE_ERROR),a=0;a<e.length;a++)l[a]=0;for(a=t;a<f._row.length;a++)if(f._row[a]^r)l[d]++;else{if(d===l.length-1){for(c=0,u=0;u<l.length;u++)c+=l[u];if((s=f._normalize(l))&&(i=f._matchPattern(s,e))<o)return h.error=i,h.start=a-c,h.end=a,h;if(!n)return null;for(u=0;u<l.length-2;u++)l[u]=l[u+2];l[l.length-2]=0,l[l.length-1]=0,d--}else d++;l[d]=1,r=!r}return null},t.prototype._findStart=function(){for(var e,t,r=this,n=r._nextSet(r._row);!t;){if(!(t=r._findPattern(r.START_PATTERN,n)))return null;if((e=t.start-(t.end-t.start))>=0&&r._matchRange(e,t.start,0))return t;n=t.end,t=null}},t.prototype._verifyTrailingWhitespace=function(e){var t;return(t=e.end+(e.end-e.start))<this._row.length&&this._matchRange(e.end,t,0)?e:null},t.prototype._findEnd=function(e,t){var r=this,n=r._findPattern(r.STOP_PATTERN,e,t,!1);return null!==n?r._verifyTrailingWhitespace(n):null},t.prototype._calculateFirstDigit=function(e){var t;for(t=0;t<this.CODE_FREQUENCY.length;t++)if(e===this.CODE_FREQUENCY[t])return t;return null},t.prototype._decodePayload=function(e,t,r){var n,o,a=this,i=0;for(n=0;n<6;n++){if(!(e=a._decodeCode(e.end)))return null;e.code>=a.CODE_G_START?(e.code=e.code-a.CODE_G_START,i|=1<<5-n):i|=0<<5-n,t.push(e.code),r.push(e)}if(null===(o=a._calculateFirstDigit(i)))return null;if(t.unshift(o),null===(e=a._findPattern(a.MIDDLE_PATTERN,e.end,!0,!1)))return null;for(r.push(e),n=0;n<6;n++){if(!(e=a._decodeCode(e.end,a.CODE_G_START)))return null;r.push(e),t.push(e.code)}return e},t.prototype._decode=function(){var e,t,r=this,n=[],o=[];return(e=r._findStart())?(t={code:e.code,start:e.start,end:e.end},o.push(t),(t=r._decodePayload(t,n,o))&&(t=r._findEnd(t.end,!1))?(o.push(t),r._checksum(n)?{code:n.join(""),start:e.start,end:t.end,codeset:"",startInfo:e,decodedCodes:o}:null):null):null},t.prototype._checksum=function(e){var t,r=0;for(t=e.length-2;t>=0;t-=2)r+=e[t];for(r*=3,t=e.length-1;t>=0;t-=2)r+=e[t];return r%10===0},t}),n("code_39_reader",["./barcode_reader","./array_helper"],function(e,t){"use strict";function r(){e.call(this)}return r.prototype=Object.create(e.prototype,{ALPHABETH_STRING:{value:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. *$/+%"},ALPHABET:{value:[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,45,46,32,42,36,47,43,37]},CHARACTER_ENCODINGS:{value:[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,148,168,162,138,42]},ASTERISK:{value:148},FORMAT:{value:"code_39",writeable:!1}}),r.prototype.constructor=r,r.prototype._toCounters=function(e,r){var n,o=this,a=r.length,i=o._row.length,u=!o._row[e],c=0;for(t.init(r,0),n=e;n<i;n++)if(o._row[n]^u)r[c]++;else{if(++c===a)break;r[c]=1,u=!u}return r},r.prototype._decode=function(){var e,r,n,o,a=this,i=[0,0,0,0,0,0,0,0,0],u=[],c=a._findStart();if(!c)return null;o=a._nextSet(a._row,c.end);do{if(i=a._toCounters(o,i),(n=a._toPattern(i))<0)return null;if((e=a._patternToChar(n))<0)return null;u.push(e),r=o,o+=t.sum(i),o=a._nextSet(a._row,o)}while("*"!==e);return u.pop(),u.length&&a._verifyTrailingWhitespace(r,o,i)?{code:u.join(""),start:c.start,end:o,startInfo:c,decodedCodes:u}:null},r.prototype._verifyTrailingWhitespace=function(e,r,n){var o=t.sum(n);return 3*(r-e-o)>=o},r.prototype._patternToChar=function(e){var t,r=this;for(t=0;t<r.CHARACTER_ENCODINGS.length;t++)if(r.CHARACTER_ENCODINGS[t]===e)return String.fromCharCode(r.ALPHABET[t])},r.prototype._findNextWidth=function(e,t){var r,n=Number.MAX_VALUE;for(r=0;r<e.length;r++)e[r]<n&&e[r]>t&&(n=e[r]);return n},r.prototype._toPattern=function(e){for(var t,r,n=e.length,o=0,a=n,i=0;a>3;){for(o=this._findNextWidth(e,o),a=0,t=0,r=0;r<n;r++)e[r]>o&&(t|=1<<n-1-r,a++,i+=e[r]);if(3===a){for(r=0;r<n&&a>0;r++)if(e[r]>o&&(a--,2*e[r]>=i))return-1;return t}}return-1},r.prototype._findStart=function(){var e,t,r,n=this,o=n._nextSet(n._row),a=o,i=[0,0,0,0,0,0,0,0,0],u=0,c=!1;for(e=o;e<n._row.length;e++)if(n._row[e]^c)i[u]++;else{if(u===i.length-1){if(n._toPattern(i)===n.ASTERISK&&(r=Math.floor(Math.max(0,a-(e-a)/4)),n._matchRange(r,a,0)))return{start:a,end:e};for(a+=i[0]+i[1],t=0;t<7;t++)i[t]=i[t+2];i[7]=0,i[8]=0,u--}else u++;i[u]=1,c=!c}return null},r}),n("code_39_vin_reader",["./code_39_reader"],function(e){"use strict";function t(){e.call(this)}var r=/[IOQ]/g,n=/[A-Z0-9]{17}/;return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._decode=function(){var t=e.prototype._decode.apply(this);if(!t)return null;var o=t.code;return o?(o=o.replace(r,"")).match(n)?this._checkChecksum(o)?(t.code=o,t):null:(console.log("Failed AZ09 pattern code:",o),null):void 0},t.prototype._checkChecksum=function(e){return!!e},t}),n("codabar_reader",["./barcode_reader"],function(e){"use strict";function t(){e.call(this),this._counters=[]}return t.prototype=Object.create(e.prototype,{ALPHABETH_STRING:{value:"0123456789-$:/.+ABCD"},ALPHABET:{value:[48,49,50,51,52,53,54,55,56,57,45,36,58,47,46,43,65,66,67,68]},CHARACTER_ENCODINGS:{value:[3,6,9,96,18,66,33,36,48,72,12,24,69,81,84,21,26,41,11,14]},START_END:{value:[26,41,11,14]},MIN_ENCODED_CHARS:{value:4},MAX_ACCEPTABLE:{value:2},PADDING:{value:1.5},FORMAT:{value:"codabar",writeable:!1}}),t.prototype.constructor=t,t.prototype._decode=function(){var e,t,r,n,o,a=this,i=[];if(this._counters=a._fillCounters(),!(e=a._findStart()))return null;n=e.startCounter;do{if((r=a._toPattern(n))<0)return null;if((t=a._patternToChar(r))<0)return null;if(i.push(t),n+=8,i.length>1&&a._isStartEnd(r))break}while(n<a._counters.length);return i.length-2<a.MIN_ENCODED_CHARS||!a._isStartEnd(r)?null:a._verifyWhitespace(e.startCounter,n-8)&&a._validateResult(i,e.startCounter)?(n=n>a._counters.length?a._counters.length:n,o=e.start+a._sumCounters(e.startCounter,n-8),{code:i.join(""),start:e.start,end:o,startInfo:e,decodedCodes:i}):null},t.prototype._verifyWhitespace=function(e,t){return(e-1<=0||this._counters[e-1]>=this._calculatePatternLength(e)/2)&&(t+8>=this._counters.length||this._counters[t+7]>=this._calculatePatternLength(t)/2)},t.prototype._calculatePatternLength=function(e){var t,r=0;for(t=e;t<e+7;t++)r+=this._counters[t];return r},t.prototype._thresholdResultPattern=function(e,t){var r,n,o,a,i,u=this,c={space:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}},bar:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}}},s=t;for(o=0;o<e.length;o++){for(i=u._charToPattern(e[o]),a=6;a>=0;a--)r=2===(1&a)?c.bar:c.space,(n=1===(1&i)?r.wide:r.narrow).size+=u._counters[s+a],n.counts++,i>>=1;s+=8}return["space","bar"].forEach(function(e){var t=c[e];t.wide.min=Math.floor((t.narrow.size/t.narrow.counts+t.wide.size/t.wide.counts)/2),t.narrow.max=Math.ceil(t.wide.min),t.wide.max=Math.ceil((t.wide.size*u.MAX_ACCEPTABLE+u.PADDING)/t.wide.counts)}),c},t.prototype._charToPattern=function(e){var t,r=this,n=e.charCodeAt(0);for(t=0;t<r.ALPHABET.length;t++)if(r.ALPHABET[t]===n)return r.CHARACTER_ENCODINGS[t];return 0},t.prototype._validateResult=function(e,t){var r,n,o,a,i,u,c=this,s=c._thresholdResultPattern(e,t),l=t;for(r=0;r<e.length;r++){for(u=c._charToPattern(e[r]),n=6;n>=0;n--){if(o=0===(1&n)?s.bar:s.space,a=1===(1&u)?o.wide:o.narrow,(i=c._counters[l+n])<a.min||i>a.max)return!1;u>>=1}l+=8}return!0},t.prototype._patternToChar=function(e){var t,r=this;for(t=0;t<r.CHARACTER_ENCODINGS.length;t++)if(r.CHARACTER_ENCODINGS[t]===e)return String.fromCharCode(r.ALPHABET[t]);return-1},t.prototype._computeAlternatingThreshold=function(e,t){var r,n,o=Number.MAX_VALUE,a=0;for(r=e;r<t;r+=2)(n=this._counters[r])>a&&(a=n),n<o&&(o=n);return(o+a)/2|0},t.prototype._toPattern=function(e){var t,r,n,o,a=e+7,i=64,u=0;if(a>this._counters.length)return-1;for(t=this._computeAlternatingThreshold(e,a),r=this._computeAlternatingThreshold(e+1,a),n=0;n<7;n++)o=0===(1&n)?t:r,this._counters[e+n]>o&&(u|=i),i>>=1;return u},t.prototype._isStartEnd=function(e){var t;for(t=0;t<this.START_END.length;t++)if(this.START_END[t]===e)return!0;return!1},t.prototype._sumCounters=function(e,t){var r,n=0;for(r=e;r<t;r++)n+=this._counters[r];return n},t.prototype._findStart=function(){var e,t,r=this,n=r._nextUnset(r._row);for(e=1;e<this._counters.length;e++)if(-1!==(t=r._toPattern(e))&&r._isStartEnd(t))return{start:n+=r._sumCounters(0,e),end:n+r._sumCounters(e,e+8),startCounter:e,endCounter:e+8}},t}),n("upc_reader",["./ean_reader"],function(e){"use strict";function t(){e.call(this)}return t.prototype=Object.create(e.prototype,{FORMAT:{value:"upc_a",writeable:!1}}),t.prototype.constructor=t,t.prototype._decode=function(){var t=e.prototype._decode.call(this);return t&&t.code&&13===t.code.length&&"0"===t.code.charAt(0)?(t.code=t.code.substring(1),t):null},t}),n("ean_8_reader",["./ean_reader"],function(e){"use strict";function t(){e.call(this)}return t.prototype=Object.create(e.prototype,{FORMAT:{value:"ean_8",writeable:!1}}),t.prototype.constructor=t,t.prototype._decodePayload=function(e,t,r){var n,o=this;for(n=0;n<4;n++){if(!(e=o._decodeCode(e.end,o.CODE_G_START)))return null;t.push(e.code),r.push(e)}if(null===(e=o._findPattern(o.MIDDLE_PATTERN,e.end,!0,!1)))return null;for(r.push(e),n=0;n<4;n++){if(!(e=o._decodeCode(e.end,o.CODE_G_START)))return null;r.push(e),t.push(e.code)}return e},t}),n("upc_e_reader",["./ean_reader"],function(e){"use strict";function t(){e.call(this)}return t.prototype=Object.create(e.prototype,{CODE_FREQUENCY:{value:[[56,52,50,49,44,38,35,42,41,37],[7,11,13,14,19,25,28,21,22,26]]},STOP_PATTERN:{value:[1/6*7,1/6*7,1/6*7,1/6*7,1/6*7,1/6*7]},FORMAT:{value:"upc_e",writeable:!1}}),t.prototype.constructor=t,t.prototype._decodePayload=function(e,t,r){var n,o=this,a=0;for(n=0;n<6;n++){if(!(e=o._decodeCode(e.end)))return null;e.code>=o.CODE_G_START&&(e.code=e.code-o.CODE_G_START,a|=1<<5-n),t.push(e.code),r.push(e)}return o._determineParity(a,t)?e:null},t.prototype._determineParity=function(e,t){var r,n,o=this;for(n=0;n<o.CODE_FREQUENCY.length;n++)for(r=0;r<o.CODE_FREQUENCY[n].length;r++)if(e===o.CODE_FREQUENCY[n][r])return t.unshift(n),t.push(r),!0;return!1},t.prototype._convertToUPCA=function(e){var t=[e[0]],r=e[e.length-2];return(t=r<=2?t.concat(e.slice(1,3)).concat([r,0,0,0,0]).concat(e.slice(3,6)):3===r?t.concat(e.slice(1,4)).concat([0,0,0,0,0]).concat(e.slice(4,6)):4===r?t.concat(e.slice(1,5)).concat([0,0,0,0,0,e[5]]):t.concat(e.slice(1,6)).concat([0,0,0,0,r])).push(e[e.length-1]),t},t.prototype._checksum=function(t){return e.prototype._checksum.call(this,this._convertToUPCA(t))},t.prototype._findEnd=function(t,r){return e.prototype._findEnd.call(this,t,true)},t.prototype._verifyTrailingWhitespace=function(e){var t;if((t=e.end+(e.end-e.start)/2)<this._row.length&&this._matchRange(e.end,t,0))return e},t}),n("html_utils",[],function(){"use strict";function e(t,r){for(var n in r)try{r[n].constructor==Object?t[n]=e(t[n],r[n]):t[n]=r[n]}catch(o){t[n]=r[n]}return t}return{createNode:function(e){return function(e){var t=document.createElement("div");for(t.innerHTML=e;t.firstChild;)return t.firstChild}(e)},mergeObjects:function(t,r){return e(t,r)}}}),n("i2of5_reader",["./barcode_reader","./html_utils"],function(e,t){"use strict";function r(n){n=t.mergeObjects(function(){var e={};return Object.keys(r.CONFIG_KEYS).forEach(function(t){e[t]=r.CONFIG_KEYS[t].default}),e}(),n),e.call(this,n),this.barSpaceRatio=[1,1],n.normalizeBarSpaceWidth&&(this.SINGLE_CODE_ERROR=.38,this.AVG_CODE_ERROR=.09)}var n={MODULO:{value:10},START_PATTERN:{value:[2.5,2.5,2.5,2.5]},STOP_PATTERN:{value:[2,2,6]},CODE_PATTERN:{value:[[1,1,3,3,1],[3,1,1,1,3],[1,3,1,1,3],[3,3,1,1,1],[1,1,3,1,3],[3,1,3,1,1],[1,3,3,1,1],[1,1,1,3,3],[3,1,1,3,1],[1,3,1,3,1]]},SINGLE_CODE_ERROR:{value:.78,writable:!0},AVG_CODE_ERROR:{value:.38,writable:!0},MAX_CORRECTION_FACTOR:{value:5},FORMAT:{value:"i2of5"}};return r.prototype=Object.create(e.prototype,n),r.prototype.constructor=r,r.prototype._matchPattern=function(t,r){if(this.config.normalizeBarSpaceWidth){var n,o=[0,0],a=[0,0],i=[0,0],u=this.MAX_CORRECTION_FACTOR,c=1/u;for(n=0;n<t.length;n++)o[n%2]+=t[n],a[n%2]+=r[n];for(i[0]=a[0]/o[0],i[1]=a[1]/o[1],i[0]=Math.max(Math.min(i[0],u),c),i[1]=Math.max(Math.min(i[1],u),c),this.barSpaceRatio=i,n=0;n<t.length;n++)t[n]*=this.barSpaceRatio[n%2]}return e.prototype._matchPattern.call(this,t,r)},r.prototype._findPattern=function(e,t,r,n){var o,a,i,u,c,s=[],l=this,f=0,d={error:Number.MAX_VALUE,code:-1,start:0,end:0},h=l.AVG_CODE_ERROR;for(r=r||!1,n=n||!1,t||(t=l._nextSet(l._row)),o=0;o<e.length;o++)s[o]=0;for(o=t;o<l._row.length;o++)if(l._row[o]^r)s[f]++;else{if(f===s.length-1){for(u=0,i=0;i<s.length;i++)u+=s[i];if((c=l._normalize(s))&&(a=l._matchPattern(c,e))<h)return d.error=a,d.start=o-u,d.end=o,d;if(!n)return null;for(i=0;i<s.length-2;i++)s[i]=s[i+2];s[s.length-2]=0,s[s.length-1]=0,f--}else f++;s[f]=1,r=!r}return null},r.prototype._findStart=function(){for(var e,t,r=this,n=r._nextSet(r._row),o=1;!t;){if(!(t=r._findPattern(r.START_PATTERN,n,!1,!0)))return null;if(o=Math.floor((t.end-t.start)/4),(e=t.start-10*o)>=0&&r._matchRange(e,t.start,0))return t;n=t.end,t=null}},r.prototype._verifyTrailingWhitespace=function(e){var t;return(t=e.end+(e.end-e.start)/2)<this._row.length&&this._matchRange(e.end,t,0)?e:null},r.prototype._findEnd=function(){var e,t,r=this;return r._row.reverse(),e=r._findPattern(r.STOP_PATTERN),r._row.reverse(),null===e?null:(t=e.start,e.start=r._row.length-e.end,e.end=r._row.length-t,null!==e?r._verifyTrailingWhitespace(e):null)},r.prototype._decodePair=function(e){var t,r,n=[];for(t=0;t<e.length;t++){if(!(r=this._decodeCode(e[t])))return null;n.push(r)}return n},r.prototype._decodeCode=function(e){var t,r,n,o,a=this,i=a.AVG_CODE_ERROR,u={error:Number.MAX_VALUE,code:-1,start:0,end:0};for(t=0;t<e.length;t++)e[t];if(r=a._normalize(e)){for(o=0;o<a.CODE_PATTERN.length;o++)(n=a._matchPattern(r,a.CODE_PATTERN[o]))<u.error&&(u.code=o,u.error=n);if(u.error<i)return u}return null},r.prototype._decodePayload=function(e,t,r){for(var n,o,a=0,i=e.length,u=[[0,0,0,0,0],[0,0,0,0,0]];a<i;){for(n=0;n<5;n++)u[0][n]=e[a]*this.barSpaceRatio[0],u[1][n]=e[a+1]*this.barSpaceRatio[1],a+=2;if(!(o=this._decodePair(u)))return null;for(n=0;n<o.length;n++)t.push(o[n].code+""),r.push(o[n])}return o},r.prototype._verifyCounterLength=function(e){return e.length%10===0},r.prototype._decode=function(){var e,t,r,n=this,o=[],a=[];return(e=n._findStart())?(a.push(e),(t=n._findEnd())?(r=n._fillCounters(e.end,t.start,!1),n._verifyCounterLength(r)&&n._decodePayload(r,o,a)?o.length%2!==0||o.length<6?null:(a.push(t),{code:o.join(""),start:e.start,end:t.end,startInfo:e,decodedCodes:a}):null):null):null},r.CONFIG_KEYS={normalizeBarSpaceWidth:{type:"boolean",default:!1,description:"If true, the reader tries to normalize thewidth-difference between bars and spaces"}},r}),n("barcode_decoder",["bresenham","image_debug","code_128_reader","ean_reader","code_39_reader","code_39_vin_reader","codabar_reader","upc_reader","ean_8_reader","upc_e_reader","i2of5_reader"],function(e,t,r,n,o,a,i,u,c,s,l){"use strict";var f={code_128_reader:r,ean_reader:n,ean_8_reader:c,code_39_reader:o,code_39_vin_reader:a,codabar_reader:i,upc_reader:u,upc_e_reader:s,i2of5_reader:l};return{create:function(r,n){var o={ctx:{frequency:null,pattern:null,overlay:null},dom:{frequency:null,pattern:null,overlay:null}},a=[];function i(){r.readers.forEach(function(e){var t,r={};"object"===typeof e?(t=e.format,r=e.config):"string"===typeof e&&(t=e),a.push(new f[t](r))}),console.log("Registered Readers: "+a.map(function(e){return JSON.stringify({format:e.FORMAT,config:e.config})}).join(", "))}function u(i){var u,c=null,s=e.getBarcodeLine(n,i[0],i[1]);for(r.showFrequency&&(t.drawPath(i,{x:"x",y:"y"},o.ctx.overlay,{color:"red",lineWidth:3}),e.debug.printFrequency(s.line,o.dom.frequency)),e.toBinaryLine(s),r.showPattern&&e.debug.printPattern(s.line,o.dom.pattern),u=0;u<a.length&&null===c;u++)c=a[u].decodePattern(s.line);return null===c?null:{codeResult:c,barcodeLine:s}}function c(e){var a,i,c,s,l=o.ctx.overlay;return r.drawBoundingBox&&l&&t.drawPath(e,{x:0,y:1},l,{color:"blue",lineWidth:2}),a=function(e){return[{x:(e[1][0]-e[0][0])/2+e[0][0],y:(e[1][1]-e[0][1])/2+e[0][1]},{x:(e[3][0]-e[2][0])/2+e[2][0],y:(e[3][1]-e[2][1])/2+e[2][1]}]}(e),s=function(e){return Math.sqrt(Math.pow(Math.abs(e[1].y-e[0].y),2)+Math.pow(Math.abs(e[1].x-e[0].x),2))}(a),null===(a=function(e,t,r){function o(r){var n=r*Math.sin(t),o=r*Math.cos(t);e[0].y-=n,e[0].x-=o,e[1].y+=n,e[1].x+=o}for(o(r);r>1&&(!n.inImageWithBorder(e[0],0)||!n.inImageWithBorder(e[1],0));)o(-(r-=Math.ceil(r/2)));return e}(a,i=Math.atan2(a[1].y-a[0].y,a[1].x-a[0].x),Math.floor(.1*s)))?null:(null===(c=u(a))&&(c=function(e,t,r){var n,o,a,i=Math.sqrt(Math.pow(e[1][0]-e[0][0],2)+Math.pow(e[1][1]-e[0][1],2)),c=null,s=Math.sin(r),l=Math.cos(r);for(n=1;n<16&&null===c;n++)a={y:(o=i/16*n*(n%2===0?-1:1))*s,x:o*l},t[0].y+=a.x,t[0].x-=a.y,t[1].y+=a.x,t[1].x-=a.y,c=u(t);return c}(e,a,i)),null===c?null:(c&&r.drawScanline&&l&&t.drawPath(a,{x:"x",y:"y"},l,{color:"red",lineWidth:3}),{codeResult:c.codeResult,line:a,angle:i,pattern:c.barcodeLine.line,threshold:c.barcodeLine.threshold}))}return function(){if("undefined"!==typeof document){var e=document.querySelector("#debug.detection");o.dom.frequency=document.querySelector("canvas.frequency"),o.dom.frequency||(o.dom.frequency=document.createElement("canvas"),o.dom.frequency.className="frequency",e&&e.appendChild(o.dom.frequency)),o.ctx.frequency=o.dom.frequency.getContext("2d"),o.dom.pattern=document.querySelector("canvas.patternBuffer"),o.dom.pattern||(o.dom.pattern=document.createElement("canvas"),o.dom.pattern.className="patternBuffer",e&&e.appendChild(o.dom.pattern)),o.ctx.pattern=o.dom.pattern.getContext("2d"),o.dom.overlay=document.querySelector("canvas.drawingBuffer"),o.dom.overlay&&(o.ctx.overlay=o.dom.overlay.getContext("2d"))}}(),i(),function(){if("undefined"!==typeof document){var e,t=[{node:o.dom.frequency,prop:r.showFrequency},{node:o.dom.pattern,prop:r.showPattern}];for(e=0;e<t.length;e++)!0===t[e].prop?t[e].node.style.display="block":t[e].node.style.display="none"}}(),{decodeFromBoundingBox:function(e){return c(e)},decodeFromBoundingBoxes:function(e){var t,r;for(t=0;t<e.length;t++)if((r=c(e[t]))&&r.codeResult)return r.box=e[t],r},setReaders:function(e){r.readers=e,a.length=0,i()}}}}}),n("frame_grabber",["cv_utils"],function(e){"use strict";var t={create:function(t,r){var n,o={},a=t.getConfig(),i=e.imageRef(t.getRealWidth(),t.getRealHeight()),u=t.getCanvasSize(),c=e.imageRef(t.getWidth(),t.getHeight()),s=t.getTopRight(),l=s.x,f=s.y,d=null,h=null;return(n=r||document.createElement("canvas")).width=u.x,n.height=u.y,d=n.getContext("2d"),h=new Uint8Array(c.x*c.y),console.log("FrameGrabber",JSON.stringify({size:c,topRight:s,videoSize:i,canvasSize:u})),o.attachData=function(e){h=e},o.getData=function(){return h},o.grab=function(){var r,n=a.halfSample,o=t.getFrame();return!!o&&(d.drawImage(o,0,0,u.x,u.y),r=d.getImageData(l,f,c.x,c.y).data,n?e.grayAndHalfSampleFromCanvasData(r,c,h):e.computeGray(r,h,a),!0)},o.getSize=function(){return c},o}};return t}),n("config",[],function(){return{inputStream:{name:"Live",type:"LiveStream",constraints:{width:640,height:480,minAspectRatio:0,maxAspectRatio:100,facing:"environment"},area:{top:"0%",right:"0%",left:"0%",bottom:"0%"},singleChannel:!1},tracking:!1,debug:!1,controls:!1,locate:!0,numOfWorkers:4,visual:{show:!0},decoder:{drawBoundingBox:!1,showFrequency:!1,drawScanline:!1,showPattern:!1,readers:["code_128_reader"]},locator:{halfSample:!0,patchSize:"medium",showCanvas:!1,showPatches:!1,showFoundPatches:!1,showSkeleton:!1,showLabels:!1,showPatchLabels:!1,showRemainingPatchLabels:!1,boxFromPatches:{showTransformed:!1,showTransformedBox:!1,showBB:!1}}}}),n("events",[],function(){"use strict";return function(){var e={};function t(t){return e[t]||(e[t]={subscribers:[]}),e[t]}function r(e,r,n){var o;if("function"===typeof r)o={callback:r,async:n};else if(!(o=r).callback)throw"Callback was not specified on options";t(e).subscribers.push(o)}return{subscribe:function(e,t,n){return r(e,t,n)},publish:function(e,r){var n=t(e),o=n.subscribers;n.subscribers=o.filter(function(e){return function(e,t){e.async?setTimeout(function(){e.callback(t)},4):e.callback(t)}(e,r),!e.once})},once:function(e,t,n){r(e,{callback:t,async:n,once:!0})},unsubscribe:function(r,n){var o;r?(o=t(r)).subscribers=o&&n?o.subscribers.filter(function(e){return e.callback!==n}):[]:e={}}}}()}),n("camera_access",["html_utils"],function(e){"use strict";var t,r;function n(e,t){var r=10;!function n(){r>0?e.videoWidth>0&&e.videoHeight>0?(console.log(e.videoWidth+"px x "+e.videoHeight+"px"),t()):window.setTimeout(n,500):t("Unable to play video stream. Is webcam working?"),r--}()}function o(e,o,a){!function(e,r,n){"undefined"!==typeof navigator.getUserMedia?navigator.getUserMedia(e,function(e){t=e;var n=window.URL&&window.URL.createObjectURL(e)||e;r.apply(null,[n])},n):n(new TypeError("getUserMedia not available"))}(e,function(e){o.src=e,r&&o.removeEventListener("loadeddata",r,!1),r=n.bind(null,o,a),o.addEventListener("loadeddata",r,!1),o.play()},function(e){a(e)})}function a(t,r,n){!function(t,r){var n={audio:!1,video:!0},o=e.mergeObjects({width:640,height:480,minAspectRatio:0,maxAspectRatio:100,facing:"environment"},t);if("undefined"===typeof MediaStreamTrack||"undefined"===typeof MediaStreamTrack.getSources)return n.video={mediaSource:"camera",width:{min:o.width,max:o.width},height:{min:o.height,max:o.height},require:["width","height"]},r(n);MediaStreamTrack.getSources(function(e){for(var t,a=0;a!=e.length;++a){var i=e[a];"video"==i.kind&&i.facing==o.facing&&(t=i.id)}return n.video={mandatory:{minWidth:o.width,minHeight:o.height,minAspectRatio:o.minAspectRatio,maxAspectRatio:o.maxAspectRatio},optional:[{sourceId:t}]},r(n)})}(r,function(e){o(e,t,n)})}return{request:function(e,t,r){a(e,t,r)},release:function(){var e=t&&t.getVideoTracks();e.length&&e[0].stop(),t=null}}}),n("result_collector",["image_debug"],function(e){"use strict";return{create:function(t){var r=document.createElement("canvas"),n=r.getContext("2d"),o=[],a=t.capacity||20,i=!0===t.capture;function u(e){return a&&e&&!function(e,t){return!!t&&t.some(function(t){return Object.keys(t).every(function(r){return t[r]===e[r]})})}(e,t.blacklist)&&function(e,t){return"function"!==typeof t||t(e)}(e,t.filter)}return{addResult:function(t,c,s){var l={};u(s)&&(a--,l.codeResult=s,i&&(r.width=c.x,r.height=c.y,e.drawImage(t,c,n),l.frame=r.toDataURL()),o.push(l))},getResults:function(){return o}}}}}),n("quagga",["input_stream","image_wrapper","barcode_locator","barcode_decoder","frame_grabber","html_utils","config","events","camera_access","image_debug","result_collector"],function(t,r,n,o,a,i,u,c,l,f,d){"use strict";var h,p,g,y,m,v,_,x={ctx:{image:null,overlay:null},dom:{image:null,overlay:null}},w=[],b=!0;function C(e){!function(e){y=e||new r({x:h.getWidth(),y:h.getHeight()});console.log(y.size),m=[s.create([0,0]),s.create([0,y.size.y]),s.create([y.size.x,y.size.y]),s.create([y.size.x,0])],n.init(y,u.locator)}(e),v=o.create(u.decoder,y)}function E(e){var r;if("VideoStream"==u.inputStream.type)r=document.createElement("video"),h=t.createVideoStream(r);else if("ImageStream"==u.inputStream.type)h=t.createImageStream();else if("LiveStream"==u.inputStream.type){var n=document.querySelector("#interactive.viewport");n&&((r=n.querySelector("video"))||(r=document.createElement("video"),n.appendChild(r))),h=t.createLiveStream(r),l.request(r,u.inputStream.constraints,function(t){if(t)return e(t);h.trigger("canrecord")})}h.setAttribute("preload","auto"),h.setAttribute("autoplay",!0),h.setInputStream(u.inputStream),h.addEventListener("canrecord",R.bind(void 0,e))}function R(e){n.checkImageConstraints(h,u.locator),function(){if("undefined"!==typeof document){var e=document.querySelector("#interactive.viewport");if(x.dom.image=document.querySelector("canvas.imgBuffer"),x.dom.image||(x.dom.image=document.createElement("canvas"),x.dom.image.className="imgBuffer",e&&"ImageStream"==u.inputStream.type&&e.appendChild(x.dom.image)),x.ctx.image=x.dom.image.getContext("2d"),x.dom.image.width=h.getCanvasSize().x,x.dom.image.height=h.getCanvasSize().y,x.dom.overlay=document.querySelector("canvas.drawingBuffer"),!x.dom.overlay){x.dom.overlay=document.createElement("canvas"),x.dom.overlay.className="drawingBuffer",e&&e.appendChild(x.dom.overlay);var t=document.createElement("br");t.setAttribute("clear","all"),e&&e.appendChild(t)}x.ctx.overlay=x.dom.overlay.getContext("2d"),x.dom.overlay.width=h.getCanvasSize().x,x.dom.overlay.height=h.getCanvasSize().y}}(),p=a.create(h,x.dom.image),function(){if("undefined"!==typeof document)for(var e=[{node:document.querySelector("div[data-controls]"),prop:u.controls},{node:x.dom.overlay,prop:u.visual.show}],t=0;t<e.length;t++)e[t].node&&(!0===e[t].prop?e[t].node.style.display="block":e[t].node.style.display="none")}(),u.numOfWorkers>0?function(e){var t;for(w=[],t=0;t<u.numOfWorkers;t++)S(r);function r(t){w.push(t),w.length>=u.numOfWorkers&&e()}}(function(){console.log("Workers created"),A(e)}):(C(),A(e))}function A(e){h.play(),e()}function T(e,t){b&&(!function(e){var t,r,n=h.getTopRight(),o=n.x,a=n.y;if(e&&(0!==o||0!==a)&&(e.line&&2===e.line.length&&((r=e.line)[0].x+=o,r[0].y+=a,r[1].x+=o,r[1].y+=a),e.boxes&&e.boxes.length>0))for(t=0;t<e.boxes.length;t++)i(e.boxes[t]);function i(e){for(var t=e.length;t--;)e[t][0]+=o,e[t][1]+=a}}(e),t&&e&&e.codeResult&&_&&_.addResult(t,h.getCanvasSize(),e.codeResult)),c.publish("processed",e),e&&e.codeResult&&c.publish("detected",e)}function M(){var e,t;(t=u.locate?n.locate():[[s.create(m[0]),s.create(m[1]),s.create(m[2]),s.create(m[3])]])?((e=(e=v.decodeFromBoundingBoxes(t))||{}).boxes=t,T(e,y.data)):T()}function O(){g=!1,function e(){g||(!function(){var e;if(b){if(w.length>0){if(!(e=w.filter(function(e){return!e.busy})[0]))return;p.attachData(e.imageData)}else p.attachData(y.data);p.grab()&&(e?(e.busy=!0,e.worker.postMessage({cmd:"process",imageData:e.imageData},[e.imageData.buffer])):M())}else M()}(),b&&"LiveStream"==u.inputStream.type&&window.requestAnimFrame(e))}()}function S(t){var r,n={worker:void 0,imageData:new Uint8Array(h.getWidth()*h.getHeight()),busy:!0};r=function(){var t,r;"undefined"!==typeof e&&(r=e);return t=new Blob(["("+D.toString()+")("+r+");"],{type:"text/javascript"}),window.URL.createObjectURL(t)}(),n.worker=new Worker(r),n.worker.onmessage=function(e){if("initialized"===e.data.event)return URL.revokeObjectURL(r),n.busy=!1,n.imageData=new Uint8Array(e.data.imageData),console.log("Worker initialized"),t(n);"processed"===e.data.event?(n.imageData=new Uint8Array(e.data.imageData),n.busy=!1,T(e.data.result,n.imageData)):"error"===e.data.event&&console.log("Worker error: "+e.data.message)},n.worker.postMessage({cmd:"init",size:{x:h.getWidth(),y:h.getHeight()},imageData:n.imageData,config:u},[n.imageData.buffer])}function D(e){if(e){var t=e();if(!t)return void self.postMessage({event:"error",message:"Quagga could not be created"})}var r;function n(e){self.postMessage({event:"processed",imageData:r.data,result:e},[r.data.buffer])}function o(){self.postMessage({event:"initialized",imageData:r.data},[r.data.buffer])}self.onmessage=function(e){if("init"===e.data.cmd){var a=e.data.config;a.numOfWorkers=0,r=new t.ImageWrapper({x:e.data.size.x,y:e.data.size.y},new Uint8Array(e.data.imageData)),t.init(a,o,r),t.onProcessed(n)}else"process"===e.data.cmd?(r.data=new Uint8Array(e.data.imageData),t.start()):"setReaders"===e.data.cmd&&t.setReaders(e.data.readers)}}return{init:function(e,t,r){if(u=i.mergeObjects(u,e),r)return b=!1,C(r),t();E(t)},start:function(){O()},stop:function(){g=!0,w.forEach(function(e){e.worker.terminate(),console.log("Worker terminated!")}),w.length=0,"LiveStream"===u.inputStream.type&&(l.release(),h.clearEventHandlers())},pause:function(){g=!0},onDetected:function(e){c.subscribe("detected",e)},offDetected:function(e){c.unsubscribe("detected",e)},onProcessed:function(e){c.subscribe("processed",e)},offProcessed:function(e){c.unsubscribe("processed",e)},setReaders:function(e){!function(e){v?v.setReaders(e):b&&w.length>0&&w.forEach(function(t){t.worker.postMessage({cmd:"setReaders",readers:e})})}(e)},registerResultCollector:function(e){e&&"function"===typeof e.addResult&&(_=e)},canvas:x,decodeSingle:function(e,t){e=i.mergeObjects({inputStream:{type:"ImageStream",sequence:!1,size:800,src:e.src},numOfWorkers:1,locator:{halfSample:!1}},e),this.init(e,function(){c.once("processed",function(e){g=!0,t.call(null,e)},!0),O()})},ImageWrapper:r,ImageDebug:f,ResultCollector:d}}),r("quagga")})}}]);
//# sourceMappingURL=911.88afc799.chunk.js.map